{"total_count":1011,"incomplete_results":false,"items":[{"url":"https://api.github.com/repos/apache/bookkeeper/commits/f4e234439ef45bdedb244bc2375e2f9d0426c20c","sha":"f4e234439ef45bdedb244bc2375e2f9d0426c20c","html_url":"https://github.com/apache/bookkeeper/commit/f4e234439ef45bdedb244bc2375e2f9d0426c20c","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/f4e234439ef45bdedb244bc2375e2f9d0426c20c/comments","commit":{"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/f4e234439ef45bdedb244bc2375e2f9d0426c20c","author":{"date":"2018-05-22T11:43:31.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"committer":{"date":"2018-05-22T11:43:31.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"message":"[TABLE SERVICE] start table service as an extra component of bookie\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\ntable service was built over bookkeeper ledgers. it is an extension to bookies' functionalities, so it is much convenient to start the service as one additional component with bookie, just like how we start `AutoRecovery` along with bookie.\n\n*Solution*\n\n- include `stream/server` module as part of bookkeeper server/all binary distributions\n- abstract `StorageServer` to allow controlling whether to start bookie or not\n- provide a ServerLifecycleComponent of `StorageServer`, so it can be used as an extra component of bookie\n\n*Tests*\n\n- improve the integration tests to start table service as part of bookie containers\n- move `LocationClientTest` to container based integration tests\n\nMaster Issue: #1205\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1422 from sijie/start_table_service","tree":{"url":"https://api.github.com/repos/apache/bookkeeper/git/trees/33e04bd968045fffa38c97e5f12a69b8d5a0d40e","sha":"33e04bd968045fffa38c97e5f12a69b8d5a0d40e"},"comment_count":0},"author":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"committer":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"parents":[{"url":"https://api.github.com/repos/apache/bookkeeper/commits/9655943e6be5ac86060134c16ec24d6f0c822f56","html_url":"https://github.com/apache/bookkeeper/commit/9655943e6be5ac86060134c16ec24d6f0c822f56","sha":"9655943e6be5ac86060134c16ec24d6f0c822f56"}],"repository":{"id":1575956,"name":"bookkeeper","full_name":"apache/bookkeeper","owner":{"login":"apache","id":47359,"avatar_url":"https://avatars0.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/apache/bookkeeper","description":"Apache Bookkeeper","fork":false,"url":"https://api.github.com/repos/apache/bookkeeper","forks_url":"https://api.github.com/repos/apache/bookkeeper/forks","keys_url":"https://api.github.com/repos/apache/bookkeeper/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/bookkeeper/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/bookkeeper/teams","hooks_url":"https://api.github.com/repos/apache/bookkeeper/hooks","issue_events_url":"https://api.github.com/repos/apache/bookkeeper/issues/events{/number}","events_url":"https://api.github.com/repos/apache/bookkeeper/events","assignees_url":"https://api.github.com/repos/apache/bookkeeper/assignees{/user}","branches_url":"https://api.github.com/repos/apache/bookkeeper/branches{/branch}","tags_url":"https://api.github.com/repos/apache/bookkeeper/tags","blobs_url":"https://api.github.com/repos/apache/bookkeeper/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/bookkeeper/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/bookkeeper/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/bookkeeper/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/bookkeeper/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/bookkeeper/languages","stargazers_url":"https://api.github.com/repos/apache/bookkeeper/stargazers","contributors_url":"https://api.github.com/repos/apache/bookkeeper/contributors","subscribers_url":"https://api.github.com/repos/apache/bookkeeper/subscribers","subscription_url":"https://api.github.com/repos/apache/bookkeeper/subscription","commits_url":"https://api.github.com/repos/apache/bookkeeper/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/bookkeeper/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/bookkeeper/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/bookkeeper/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/{+path}","compare_url":"https://api.github.com/repos/apache/bookkeeper/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/bookkeeper/merges","archive_url":"https://api.github.com/repos/apache/bookkeeper/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/bookkeeper/downloads","issues_url":"https://api.github.com/repos/apache/bookkeeper/issues{/number}","pulls_url":"https://api.github.com/repos/apache/bookkeeper/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/bookkeeper/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/bookkeeper/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/bookkeeper/labels{/name}","releases_url":"https://api.github.com/repos/apache/bookkeeper/releases{/id}","deployments_url":"https://api.github.com/repos/apache/bookkeeper/deployments"},"score":21.440798},{"url":"https://api.github.com/repos/apache/bookkeeper/commits/445347cdc82aef61104bb8afced6b333bfc041b9","sha":"445347cdc82aef61104bb8afced6b333bfc041b9","html_url":"https://github.com/apache/bookkeeper/commit/445347cdc82aef61104bb8afced6b333bfc041b9","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/445347cdc82aef61104bb8afced6b333bfc041b9/comments","commit":{"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/445347cdc82aef61104bb8afced6b333bfc041b9","author":{"date":"2018-05-22T00:27:46.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"committer":{"date":"2018-05-22T00:27:46.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"message":"Build stream modules for integration tests\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\napache/bookkeeper#1422 adds table service as part of integration tests. so we need to build stream modules\nin order to run integration tests for apache/bookkeeper#1422\n\n*Solution*\n\nAdd \"-Dstream\" in the maven commands for `precommit-integrationtests` CI job.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1424 from sijie/compile_stream_module","tree":{"url":"https://api.github.com/repos/apache/bookkeeper/git/trees/1669290ec11dcd17cd1d0b6db951ba1cf962be57","sha":"1669290ec11dcd17cd1d0b6db951ba1cf962be57"},"comment_count":0},"author":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"committer":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"parents":[{"url":"https://api.github.com/repos/apache/bookkeeper/commits/f6778ab7c1424bc5d71b6b52337649c0b06ae669","html_url":"https://github.com/apache/bookkeeper/commit/f6778ab7c1424bc5d71b6b52337649c0b06ae669","sha":"f6778ab7c1424bc5d71b6b52337649c0b06ae669"}],"repository":{"id":1575956,"name":"bookkeeper","full_name":"apache/bookkeeper","owner":{"login":"apache","id":47359,"avatar_url":"https://avatars0.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/apache/bookkeeper","description":"Apache Bookkeeper","fork":false,"url":"https://api.github.com/repos/apache/bookkeeper","forks_url":"https://api.github.com/repos/apache/bookkeeper/forks","keys_url":"https://api.github.com/repos/apache/bookkeeper/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/bookkeeper/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/bookkeeper/teams","hooks_url":"https://api.github.com/repos/apache/bookkeeper/hooks","issue_events_url":"https://api.github.com/repos/apache/bookkeeper/issues/events{/number}","events_url":"https://api.github.com/repos/apache/bookkeeper/events","assignees_url":"https://api.github.com/repos/apache/bookkeeper/assignees{/user}","branches_url":"https://api.github.com/repos/apache/bookkeeper/branches{/branch}","tags_url":"https://api.github.com/repos/apache/bookkeeper/tags","blobs_url":"https://api.github.com/repos/apache/bookkeeper/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/bookkeeper/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/bookkeeper/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/bookkeeper/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/bookkeeper/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/bookkeeper/languages","stargazers_url":"https://api.github.com/repos/apache/bookkeeper/stargazers","contributors_url":"https://api.github.com/repos/apache/bookkeeper/contributors","subscribers_url":"https://api.github.com/repos/apache/bookkeeper/subscribers","subscription_url":"https://api.github.com/repos/apache/bookkeeper/subscription","commits_url":"https://api.github.com/repos/apache/bookkeeper/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/bookkeeper/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/bookkeeper/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/bookkeeper/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/{+path}","compare_url":"https://api.github.com/repos/apache/bookkeeper/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/bookkeeper/merges","archive_url":"https://api.github.com/repos/apache/bookkeeper/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/bookkeeper/downloads","issues_url":"https://api.github.com/repos/apache/bookkeeper/issues{/number}","pulls_url":"https://api.github.com/repos/apache/bookkeeper/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/bookkeeper/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/bookkeeper/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/bookkeeper/labels{/name}","releases_url":"https://api.github.com/repos/apache/bookkeeper/releases{/id}","deployments_url":"https://api.github.com/repos/apache/bookkeeper/deployments"},"score":22.000648},{"url":"https://api.github.com/repos/apache/bookkeeper/commits/0fd1f4f81ff9acf3ab6776a8afc5f3673b786a2d","sha":"0fd1f4f81ff9acf3ab6776a8afc5f3673b786a2d","html_url":"https://github.com/apache/bookkeeper/commit/0fd1f4f81ff9acf3ab6776a8afc5f3673b786a2d","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/0fd1f4f81ff9acf3ab6776a8afc5f3673b786a2d/comments","commit":{"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/0fd1f4f81ff9acf3ab6776a8afc5f3673b786a2d","author":{"date":"2018-05-21T14:54:52.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"committer":{"date":"2018-05-21T14:54:52.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"message":"Provide zookeeper startup script\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nZooKeeper is a dependency of bookkeeper shipped along with bookkeeper dist package. However we never provide any script to startup zookeeper in the bookkeeper binary package and never test the zookeeper version shipped along with bookkeeper\n\n*Solution*\n\n- add zookeeper in `bin/bookeeper` scripts to start zookeeper using bookkeeper scripts\n- refactor bookkeeper docker scripts to start bookie/zookeeper/standalone\n- use zk adminPort for health check, since 4letters commands are explicitly disabled at 3.5\n\n*Tests*\n\nExisting integration tests test the docker scripts and the bash script changes to start zookeeper.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1416 from sijie/package_zookeeper","tree":{"url":"https://api.github.com/repos/apache/bookkeeper/git/trees/6043fe0b50c4cbc32d6a84b345348cdf837f9c72","sha":"6043fe0b50c4cbc32d6a84b345348cdf837f9c72"},"comment_count":0},"author":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"committer":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"parents":[{"url":"https://api.github.com/repos/apache/bookkeeper/commits/9ba4c4e0d8be770e03110a958fb8b75a65ae0f59","html_url":"https://github.com/apache/bookkeeper/commit/9ba4c4e0d8be770e03110a958fb8b75a65ae0f59","sha":"9ba4c4e0d8be770e03110a958fb8b75a65ae0f59"}],"repository":{"id":1575956,"name":"bookkeeper","full_name":"apache/bookkeeper","owner":{"login":"apache","id":47359,"avatar_url":"https://avatars0.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/apache/bookkeeper","description":"Apache Bookkeeper","fork":false,"url":"https://api.github.com/repos/apache/bookkeeper","forks_url":"https://api.github.com/repos/apache/bookkeeper/forks","keys_url":"https://api.github.com/repos/apache/bookkeeper/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/bookkeeper/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/bookkeeper/teams","hooks_url":"https://api.github.com/repos/apache/bookkeeper/hooks","issue_events_url":"https://api.github.com/repos/apache/bookkeeper/issues/events{/number}","events_url":"https://api.github.com/repos/apache/bookkeeper/events","assignees_url":"https://api.github.com/repos/apache/bookkeeper/assignees{/user}","branches_url":"https://api.github.com/repos/apache/bookkeeper/branches{/branch}","tags_url":"https://api.github.com/repos/apache/bookkeeper/tags","blobs_url":"https://api.github.com/repos/apache/bookkeeper/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/bookkeeper/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/bookkeeper/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/bookkeeper/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/bookkeeper/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/bookkeeper/languages","stargazers_url":"https://api.github.com/repos/apache/bookkeeper/stargazers","contributors_url":"https://api.github.com/repos/apache/bookkeeper/contributors","subscribers_url":"https://api.github.com/repos/apache/bookkeeper/subscribers","subscription_url":"https://api.github.com/repos/apache/bookkeeper/subscription","commits_url":"https://api.github.com/repos/apache/bookkeeper/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/bookkeeper/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/bookkeeper/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/bookkeeper/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/{+path}","compare_url":"https://api.github.com/repos/apache/bookkeeper/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/bookkeeper/merges","archive_url":"https://api.github.com/repos/apache/bookkeeper/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/bookkeeper/downloads","issues_url":"https://api.github.com/repos/apache/bookkeeper/issues{/number}","pulls_url":"https://api.github.com/repos/apache/bookkeeper/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/bookkeeper/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/bookkeeper/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/bookkeeper/labels{/name}","releases_url":"https://api.github.com/repos/apache/bookkeeper/releases{/id}","deployments_url":"https://api.github.com/repos/apache/bookkeeper/deployments"},"score":22.465094},{"url":"https://api.github.com/repos/apache/bookkeeper/commits/5bdfbf6a673b69a9027f85ad4e82c427d41646be","sha":"5bdfbf6a673b69a9027f85ad4e82c427d41646be","html_url":"https://github.com/apache/bookkeeper/commit/5bdfbf6a673b69a9027f85ad4e82c427d41646be","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/5bdfbf6a673b69a9027f85ad4e82c427d41646be/comments","commit":{"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/5bdfbf6a673b69a9027f85ad4e82c427d41646be","author":{"date":"2018-05-18T12:49:31.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"committer":{"date":"2018-05-18T12:49:31.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"message":"Add a docker based `BookKeeperClusterTestBase` for failure related integration tests\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nCurrently we don't have any failure related testing for table service. Since we are using docker as the integration testing infrastructure,\nIt is better to use container for those failure testings, rather than going down the path as what we did before.\n\n*Solution*\n\nThis change provides the basic test base for bookkeeper cluster using dockers. `BookKeeperClusterTestBase` provides the similar functionalities\nto start/stop bookies as what we did in the unit test.\n\n`bookkeeper/tests/containers` in `integration-tests-topologies` provides all the basic containers used for testing.\n`tests/integration/cluster` and `tests/integration/topologies` provides the test base for writing tests using dockerized bookkeeper cluster.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1412 from sijie/docker_cluster_dev","tree":{"url":"https://api.github.com/repos/apache/bookkeeper/git/trees/788a6766c9a5a964e6e80ea2ce2c0dedcb362376","sha":"788a6766c9a5a964e6e80ea2ce2c0dedcb362376"},"comment_count":0},"author":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"committer":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"parents":[{"url":"https://api.github.com/repos/apache/bookkeeper/commits/2414ce0526f64663d6ceab1b642862ff6f8eb1fa","html_url":"https://github.com/apache/bookkeeper/commit/2414ce0526f64663d6ceab1b642862ff6f8eb1fa","sha":"2414ce0526f64663d6ceab1b642862ff6f8eb1fa"}],"repository":{"id":1575956,"name":"bookkeeper","full_name":"apache/bookkeeper","owner":{"login":"apache","id":47359,"avatar_url":"https://avatars0.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/apache/bookkeeper","description":"Apache Bookkeeper","fork":false,"url":"https://api.github.com/repos/apache/bookkeeper","forks_url":"https://api.github.com/repos/apache/bookkeeper/forks","keys_url":"https://api.github.com/repos/apache/bookkeeper/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/bookkeeper/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/bookkeeper/teams","hooks_url":"https://api.github.com/repos/apache/bookkeeper/hooks","issue_events_url":"https://api.github.com/repos/apache/bookkeeper/issues/events{/number}","events_url":"https://api.github.com/repos/apache/bookkeeper/events","assignees_url":"https://api.github.com/repos/apache/bookkeeper/assignees{/user}","branches_url":"https://api.github.com/repos/apache/bookkeeper/branches{/branch}","tags_url":"https://api.github.com/repos/apache/bookkeeper/tags","blobs_url":"https://api.github.com/repos/apache/bookkeeper/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/bookkeeper/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/bookkeeper/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/bookkeeper/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/bookkeeper/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/bookkeeper/languages","stargazers_url":"https://api.github.com/repos/apache/bookkeeper/stargazers","contributors_url":"https://api.github.com/repos/apache/bookkeeper/contributors","subscribers_url":"https://api.github.com/repos/apache/bookkeeper/subscribers","subscription_url":"https://api.github.com/repos/apache/bookkeeper/subscription","commits_url":"https://api.github.com/repos/apache/bookkeeper/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/bookkeeper/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/bookkeeper/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/bookkeeper/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/{+path}","compare_url":"https://api.github.com/repos/apache/bookkeeper/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/bookkeeper/merges","archive_url":"https://api.github.com/repos/apache/bookkeeper/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/bookkeeper/downloads","issues_url":"https://api.github.com/repos/apache/bookkeeper/issues{/number}","pulls_url":"https://api.github.com/repos/apache/bookkeeper/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/bookkeeper/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/bookkeeper/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/bookkeeper/labels{/name}","releases_url":"https://api.github.com/repos/apache/bookkeeper/releases{/id}","deployments_url":"https://api.github.com/repos/apache/bookkeeper/deployments"},"score":21.61577},{"url":"https://api.github.com/repos/apache/bookkeeper/commits/2414ce0526f64663d6ceab1b642862ff6f8eb1fa","sha":"2414ce0526f64663d6ceab1b642862ff6f8eb1fa","html_url":"https://github.com/apache/bookkeeper/commit/2414ce0526f64663d6ceab1b642862ff6f8eb1fa","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/2414ce0526f64663d6ceab1b642862ff6f8eb1fa/comments","commit":{"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/2414ce0526f64663d6ceab1b642862ff6f8eb1fa","author":{"date":"2018-05-17T01:39:04.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"committer":{"date":"2018-05-17T01:39:04.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"message":"Add a test docker image for current version only\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nThe current test images don't use any scripts that shipped with official docker image.\nWe basically don't have any test coverage on the official docker image we shipped for each release.\n\n*Solution*\n\nIntroduce a `bookkeeper-current` image representing an image for latest master.\n\nUse `apachebookkeeper/all-versions-image` for BC tests, use `apachebookkeeper/bookkeeper-current` as tests only needs latest master image.\n\nAdd an integration test to test standalone mode using the `bookkeeper-current` image\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1408 from sijie/docker_dev","tree":{"url":"https://api.github.com/repos/apache/bookkeeper/git/trees/94d0cf15fcfc2f6a625f85d86f231d1955e50f74","sha":"94d0cf15fcfc2f6a625f85d86f231d1955e50f74"},"comment_count":0},"author":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"committer":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"parents":[{"url":"https://api.github.com/repos/apache/bookkeeper/commits/8c077a93e50ea844e0c39ca042ed2aa8cbd6d256","html_url":"https://github.com/apache/bookkeeper/commit/8c077a93e50ea844e0c39ca042ed2aa8cbd6d256","sha":"8c077a93e50ea844e0c39ca042ed2aa8cbd6d256"}],"repository":{"id":1575956,"name":"bookkeeper","full_name":"apache/bookkeeper","owner":{"login":"apache","id":47359,"avatar_url":"https://avatars0.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/apache/bookkeeper","description":"Apache Bookkeeper","fork":false,"url":"https://api.github.com/repos/apache/bookkeeper","forks_url":"https://api.github.com/repos/apache/bookkeeper/forks","keys_url":"https://api.github.com/repos/apache/bookkeeper/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/bookkeeper/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/bookkeeper/teams","hooks_url":"https://api.github.com/repos/apache/bookkeeper/hooks","issue_events_url":"https://api.github.com/repos/apache/bookkeeper/issues/events{/number}","events_url":"https://api.github.com/repos/apache/bookkeeper/events","assignees_url":"https://api.github.com/repos/apache/bookkeeper/assignees{/user}","branches_url":"https://api.github.com/repos/apache/bookkeeper/branches{/branch}","tags_url":"https://api.github.com/repos/apache/bookkeeper/tags","blobs_url":"https://api.github.com/repos/apache/bookkeeper/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/bookkeeper/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/bookkeeper/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/bookkeeper/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/bookkeeper/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/bookkeeper/languages","stargazers_url":"https://api.github.com/repos/apache/bookkeeper/stargazers","contributors_url":"https://api.github.com/repos/apache/bookkeeper/contributors","subscribers_url":"https://api.github.com/repos/apache/bookkeeper/subscribers","subscription_url":"https://api.github.com/repos/apache/bookkeeper/subscription","commits_url":"https://api.github.com/repos/apache/bookkeeper/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/bookkeeper/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/bookkeeper/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/bookkeeper/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/{+path}","compare_url":"https://api.github.com/repos/apache/bookkeeper/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/bookkeeper/merges","archive_url":"https://api.github.com/repos/apache/bookkeeper/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/bookkeeper/downloads","issues_url":"https://api.github.com/repos/apache/bookkeeper/issues{/number}","pulls_url":"https://api.github.com/repos/apache/bookkeeper/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/bookkeeper/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/bookkeeper/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/bookkeeper/labels{/name}","releases_url":"https://api.github.com/repos/apache/bookkeeper/releases{/id}","deployments_url":"https://api.github.com/repos/apache/bookkeeper/deployments"},"score":21.560608},{"url":"https://api.github.com/repos/apache/bookkeeper/commits/7446d5c5d999c88de3cf2b9a36d793295c751a91","sha":"7446d5c5d999c88de3cf2b9a36d793295c751a91","html_url":"https://github.com/apache/bookkeeper/commit/7446d5c5d999c88de3cf2b9a36d793295c751a91","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/7446d5c5d999c88de3cf2b9a36d793295c751a91/comments","commit":{"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/7446d5c5d999c88de3cf2b9a36d793295c751a91","author":{"date":"2018-05-16T21:00:42.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"committer":{"date":"2018-05-16T21:00:42.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"message":"Refactor bookkeeper bash scripts and move dlog script to root bin directory\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nSince 4.7, we have moved bash scripts and configuration to the root directory. However the scripts and configurations for dlog and table-service modules are still in their own modules. It is inconvenient and confusing. This change mainly refactor current bookkeeper script to make it reusable for other modules.\n\n*Code Change*\n\nThe main changes are:\n\n- abstract the common logic in `bin/bookkeeper` to `bin/common.sh`. These common logics include:\n   * common definitions on environment variables, such jvm settings, bk conf, log4j conf, classpath and such.\n   * common functions can be reusable, such as find jars, add maven dependencies.\n- simplify `bin/bookkeeper` and `bin/bookkeeper-cli` by reusing `bin/common.sh`\n- remove `stream/distributedlog/core/bin/dlog` to `bin/dlog` and simplify it by reusing `bin/common.sh`\n\n*Tests*\n\nMost of the changes in this PR are tests to ensure this script refactor is done correctly.\n\n- introduced a module `tests/scripts` for testing all the bash scripts in bookkeeper project. This module uses [shUnit2](https://github.com/kward/shunit2) for testing bash scripts. This gives a good test coverage on `bin/common.sh`.\n\n- add a few CLI smoketests under `tests/integration/smoke` to smoke test all CLI tools, including `bin/bookkeeper shell`, `bin/bookkeeper-cli` and `bin/dlog`. This makes sure all the CLI scripts work well after refactor.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1407 from sijie/include_dlog_library","tree":{"url":"https://api.github.com/repos/apache/bookkeeper/git/trees/aed837a794eae71e320326e211ffeeb0ac4eebd9","sha":"aed837a794eae71e320326e211ffeeb0ac4eebd9"},"comment_count":0},"author":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"committer":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"parents":[{"url":"https://api.github.com/repos/apache/bookkeeper/commits/92591733c8b778f63cd71a00b2c7ed2c69c41312","html_url":"https://github.com/apache/bookkeeper/commit/92591733c8b778f63cd71a00b2c7ed2c69c41312","sha":"92591733c8b778f63cd71a00b2c7ed2c69c41312"}],"repository":{"id":1575956,"name":"bookkeeper","full_name":"apache/bookkeeper","owner":{"login":"apache","id":47359,"avatar_url":"https://avatars0.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/apache/bookkeeper","description":"Apache Bookkeeper","fork":false,"url":"https://api.github.com/repos/apache/bookkeeper","forks_url":"https://api.github.com/repos/apache/bookkeeper/forks","keys_url":"https://api.github.com/repos/apache/bookkeeper/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/bookkeeper/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/bookkeeper/teams","hooks_url":"https://api.github.com/repos/apache/bookkeeper/hooks","issue_events_url":"https://api.github.com/repos/apache/bookkeeper/issues/events{/number}","events_url":"https://api.github.com/repos/apache/bookkeeper/events","assignees_url":"https://api.github.com/repos/apache/bookkeeper/assignees{/user}","branches_url":"https://api.github.com/repos/apache/bookkeeper/branches{/branch}","tags_url":"https://api.github.com/repos/apache/bookkeeper/tags","blobs_url":"https://api.github.com/repos/apache/bookkeeper/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/bookkeeper/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/bookkeeper/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/bookkeeper/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/bookkeeper/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/bookkeeper/languages","stargazers_url":"https://api.github.com/repos/apache/bookkeeper/stargazers","contributors_url":"https://api.github.com/repos/apache/bookkeeper/contributors","subscribers_url":"https://api.github.com/repos/apache/bookkeeper/subscribers","subscription_url":"https://api.github.com/repos/apache/bookkeeper/subscription","commits_url":"https://api.github.com/repos/apache/bookkeeper/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/bookkeeper/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/bookkeeper/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/bookkeeper/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/{+path}","compare_url":"https://api.github.com/repos/apache/bookkeeper/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/bookkeeper/merges","archive_url":"https://api.github.com/repos/apache/bookkeeper/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/bookkeeper/downloads","issues_url":"https://api.github.com/repos/apache/bookkeeper/issues{/number}","pulls_url":"https://api.github.com/repos/apache/bookkeeper/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/bookkeeper/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/bookkeeper/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/bookkeeper/labels{/name}","releases_url":"https://api.github.com/repos/apache/bookkeeper/releases{/id}","deployments_url":"https://api.github.com/repos/apache/bookkeeper/deployments"},"score":22.095272},{"url":"https://api.github.com/repos/apache/bookkeeper/commits/6a48cd580814d71f931668fd78025f70aecf485c","sha":"6a48cd580814d71f931668fd78025f70aecf485c","html_url":"https://github.com/apache/bookkeeper/commit/6a48cd580814d71f931668fd78025f70aecf485c","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/6a48cd580814d71f931668fd78025f70aecf485c/comments","commit":{"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/6a48cd580814d71f931668fd78025f70aecf485c","author":{"date":"2018-05-14T13:03:54.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"committer":{"date":"2018-05-14T13:03:54.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"message":"Issue #1396: Export metrics in same http server\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nCurrently metrics provider and http admin endpoint are isolated due to the way how things are modularized.\nThis requires two ports to be used, one is for metrics provider to expose metrics, while the other one is used by\nhttp admin endpoint for expose admin endpoints.\n\nWhen implementing a bookkeeper operator on k8s, it becomes confusing on managing those ports and do health checks.\nIt would be good to allow export metrics in same http admin endpoint if it is enabled.\n\n*Solution*\n\n- Introduce a method `writeAllMetrics` in stats provider to allow stats provider exporting metrics.\n- Add a `MetricsService` in bookie http service and export stats provider's metrics under `/metrics` endpoint.\n\nThis fixes #1396\n\nMaster Issue: #1396\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1399 from sijie/same_http_metrics_port, closes #1396","tree":{"url":"https://api.github.com/repos/apache/bookkeeper/git/trees/d2afdbd3ff302f907eaeb36d73dfa90e85273161","sha":"d2afdbd3ff302f907eaeb36d73dfa90e85273161"},"comment_count":0},"author":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"committer":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"parents":[{"url":"https://api.github.com/repos/apache/bookkeeper/commits/94c7ce0ba535181bc0fa78c4cb4cc612b1d6b773","html_url":"https://github.com/apache/bookkeeper/commit/94c7ce0ba535181bc0fa78c4cb4cc612b1d6b773","sha":"94c7ce0ba535181bc0fa78c4cb4cc612b1d6b773"}],"repository":{"id":1575956,"name":"bookkeeper","full_name":"apache/bookkeeper","owner":{"login":"apache","id":47359,"avatar_url":"https://avatars0.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/apache/bookkeeper","description":"Apache Bookkeeper","fork":false,"url":"https://api.github.com/repos/apache/bookkeeper","forks_url":"https://api.github.com/repos/apache/bookkeeper/forks","keys_url":"https://api.github.com/repos/apache/bookkeeper/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/bookkeeper/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/bookkeeper/teams","hooks_url":"https://api.github.com/repos/apache/bookkeeper/hooks","issue_events_url":"https://api.github.com/repos/apache/bookkeeper/issues/events{/number}","events_url":"https://api.github.com/repos/apache/bookkeeper/events","assignees_url":"https://api.github.com/repos/apache/bookkeeper/assignees{/user}","branches_url":"https://api.github.com/repos/apache/bookkeeper/branches{/branch}","tags_url":"https://api.github.com/repos/apache/bookkeeper/tags","blobs_url":"https://api.github.com/repos/apache/bookkeeper/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/bookkeeper/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/bookkeeper/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/bookkeeper/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/bookkeeper/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/bookkeeper/languages","stargazers_url":"https://api.github.com/repos/apache/bookkeeper/stargazers","contributors_url":"https://api.github.com/repos/apache/bookkeeper/contributors","subscribers_url":"https://api.github.com/repos/apache/bookkeeper/subscribers","subscription_url":"https://api.github.com/repos/apache/bookkeeper/subscription","commits_url":"https://api.github.com/repos/apache/bookkeeper/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/bookkeeper/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/bookkeeper/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/bookkeeper/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/{+path}","compare_url":"https://api.github.com/repos/apache/bookkeeper/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/bookkeeper/merges","archive_url":"https://api.github.com/repos/apache/bookkeeper/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/bookkeeper/downloads","issues_url":"https://api.github.com/repos/apache/bookkeeper/issues{/number}","pulls_url":"https://api.github.com/repos/apache/bookkeeper/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/bookkeeper/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/bookkeeper/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/bookkeeper/labels{/name}","releases_url":"https://api.github.com/repos/apache/bookkeeper/releases{/id}","deployments_url":"https://api.github.com/repos/apache/bookkeeper/deployments"},"score":20.718403},{"url":"https://api.github.com/repos/apache/bookkeeper/commits/cd71e0981dffa92edf51f9665117a30265b1cf4a","sha":"cd71e0981dffa92edf51f9665117a30265b1cf4a","html_url":"https://github.com/apache/bookkeeper/commit/cd71e0981dffa92edf51f9665117a30265b1cf4a","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/cd71e0981dffa92edf51f9665117a30265b1cf4a/comments","commit":{"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/cd71e0981dffa92edf51f9665117a30265b1cf4a","author":{"date":"2018-05-12T19:32:57.000+08:00","name":"Sijie Guo","email":"sijie@apache.org"},"committer":{"date":"2018-05-12T19:32:57.000+08:00","name":"Sijie Guo","email":"sijie@apache.org"},"message":"Fix TestSmoke#testTailingReads\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nTestSmoke#testTailingReads is testing the tailing behavior at bookkeeper. However the current testing logic is a bit\nproblematic on checking whether the reader has caught up with the expected last add confirmed. so the read logic break\nearlier before reading the expectedLastConfirmedEntry.\n\n*Solution*\n\nFix the checking logic on breaking the read loop.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1402 from sijie/fix_integration_tests","tree":{"url":"https://api.github.com/repos/apache/bookkeeper/git/trees/221602c8ddb5e96a2f4bdb5ce4e72af95b55a6be","sha":"221602c8ddb5e96a2f4bdb5ce4e72af95b55a6be"},"comment_count":0},"author":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"committer":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"parents":[{"url":"https://api.github.com/repos/apache/bookkeeper/commits/eec48c4e21145c361dcbd749ab699922dfc0c68c","html_url":"https://github.com/apache/bookkeeper/commit/eec48c4e21145c361dcbd749ab699922dfc0c68c","sha":"eec48c4e21145c361dcbd749ab699922dfc0c68c"}],"repository":{"id":1575956,"name":"bookkeeper","full_name":"apache/bookkeeper","owner":{"login":"apache","id":47359,"avatar_url":"https://avatars0.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/apache/bookkeeper","description":"Apache Bookkeeper","fork":false,"url":"https://api.github.com/repos/apache/bookkeeper","forks_url":"https://api.github.com/repos/apache/bookkeeper/forks","keys_url":"https://api.github.com/repos/apache/bookkeeper/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/bookkeeper/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/bookkeeper/teams","hooks_url":"https://api.github.com/repos/apache/bookkeeper/hooks","issue_events_url":"https://api.github.com/repos/apache/bookkeeper/issues/events{/number}","events_url":"https://api.github.com/repos/apache/bookkeeper/events","assignees_url":"https://api.github.com/repos/apache/bookkeeper/assignees{/user}","branches_url":"https://api.github.com/repos/apache/bookkeeper/branches{/branch}","tags_url":"https://api.github.com/repos/apache/bookkeeper/tags","blobs_url":"https://api.github.com/repos/apache/bookkeeper/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/bookkeeper/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/bookkeeper/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/bookkeeper/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/bookkeeper/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/bookkeeper/languages","stargazers_url":"https://api.github.com/repos/apache/bookkeeper/stargazers","contributors_url":"https://api.github.com/repos/apache/bookkeeper/contributors","subscribers_url":"https://api.github.com/repos/apache/bookkeeper/subscribers","subscription_url":"https://api.github.com/repos/apache/bookkeeper/subscription","commits_url":"https://api.github.com/repos/apache/bookkeeper/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/bookkeeper/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/bookkeeper/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/bookkeeper/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/{+path}","compare_url":"https://api.github.com/repos/apache/bookkeeper/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/bookkeeper/merges","archive_url":"https://api.github.com/repos/apache/bookkeeper/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/bookkeeper/downloads","issues_url":"https://api.github.com/repos/apache/bookkeeper/issues{/number}","pulls_url":"https://api.github.com/repos/apache/bookkeeper/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/bookkeeper/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/bookkeeper/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/bookkeeper/labels{/name}","releases_url":"https://api.github.com/repos/apache/bookkeeper/releases{/id}","deployments_url":"https://api.github.com/repos/apache/bookkeeper/deployments"},"score":21.038986},{"url":"https://api.github.com/repos/apache/bookkeeper/commits/eec48c4e21145c361dcbd749ab699922dfc0c68c","sha":"eec48c4e21145c361dcbd749ab699922dfc0c68c","html_url":"https://github.com/apache/bookkeeper/commit/eec48c4e21145c361dcbd749ab699922dfc0c68c","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/eec48c4e21145c361dcbd749ab699922dfc0c68c/comments","commit":{"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/eec48c4e21145c361dcbd749ab699922dfc0c68c","author":{"date":"2018-05-12T14:45:25.000+08:00","name":"Sijie Guo","email":"sijie@apache.org"},"committer":{"date":"2018-05-12T14:45:25.000+08:00","name":"Sijie Guo","email":"sijie@apache.org"},"message":"Provide a vagrantfile to launch a linux vm for running integration tests\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nCurrently all bookkeeper's integration tests and bc tests are docker based and written\nusing arquillian framework. Due to the network issues in docker and the way how bookies\nadvertise themselves in the cluster, we can *ONLY* run integration tests in a linux\nenvironment. It is inconvinient to people who is using macOS as the development environment.\n\n*Solution*\n\nThis PR is providing a Vagrantfile to lanuch a dev vm that contains all the tools required\nfor running integration tests and bc tests. So people can actually debug and test integration\ntests locally using a linux vm.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1401 from sijie/vagrant_files","tree":{"url":"https://api.github.com/repos/apache/bookkeeper/git/trees/44c0fba0363c2ca2b591e531cdd1ecec15bb708e","sha":"44c0fba0363c2ca2b591e531cdd1ecec15bb708e"},"comment_count":0},"author":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"committer":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"parents":[{"url":"https://api.github.com/repos/apache/bookkeeper/commits/175c8ded8417bb50467218edcce5fc2971f0752e","html_url":"https://github.com/apache/bookkeeper/commit/175c8ded8417bb50467218edcce5fc2971f0752e","sha":"175c8ded8417bb50467218edcce5fc2971f0752e"}],"repository":{"id":1575956,"name":"bookkeeper","full_name":"apache/bookkeeper","owner":{"login":"apache","id":47359,"avatar_url":"https://avatars0.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/apache/bookkeeper","description":"Apache Bookkeeper","fork":false,"url":"https://api.github.com/repos/apache/bookkeeper","forks_url":"https://api.github.com/repos/apache/bookkeeper/forks","keys_url":"https://api.github.com/repos/apache/bookkeeper/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/bookkeeper/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/bookkeeper/teams","hooks_url":"https://api.github.com/repos/apache/bookkeeper/hooks","issue_events_url":"https://api.github.com/repos/apache/bookkeeper/issues/events{/number}","events_url":"https://api.github.com/repos/apache/bookkeeper/events","assignees_url":"https://api.github.com/repos/apache/bookkeeper/assignees{/user}","branches_url":"https://api.github.com/repos/apache/bookkeeper/branches{/branch}","tags_url":"https://api.github.com/repos/apache/bookkeeper/tags","blobs_url":"https://api.github.com/repos/apache/bookkeeper/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/bookkeeper/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/bookkeeper/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/bookkeeper/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/bookkeeper/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/bookkeeper/languages","stargazers_url":"https://api.github.com/repos/apache/bookkeeper/stargazers","contributors_url":"https://api.github.com/repos/apache/bookkeeper/contributors","subscribers_url":"https://api.github.com/repos/apache/bookkeeper/subscribers","subscription_url":"https://api.github.com/repos/apache/bookkeeper/subscription","commits_url":"https://api.github.com/repos/apache/bookkeeper/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/bookkeeper/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/bookkeeper/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/bookkeeper/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/{+path}","compare_url":"https://api.github.com/repos/apache/bookkeeper/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/bookkeeper/merges","archive_url":"https://api.github.com/repos/apache/bookkeeper/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/bookkeeper/downloads","issues_url":"https://api.github.com/repos/apache/bookkeeper/issues{/number}","pulls_url":"https://api.github.com/repos/apache/bookkeeper/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/bookkeeper/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/bookkeeper/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/bookkeeper/labels{/name}","releases_url":"https://api.github.com/repos/apache/bookkeeper/releases{/id}","deployments_url":"https://api.github.com/repos/apache/bookkeeper/deployments"},"score":20.623081},{"url":"https://api.github.com/repos/apache/bookkeeper/commits/8e7583b4c691dc44bb9057a2fe472a44184346a5","sha":"8e7583b4c691dc44bb9057a2fe472a44184346a5","html_url":"https://github.com/apache/bookkeeper/commit/8e7583b4c691dc44bb9057a2fe472a44184346a5","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/8e7583b4c691dc44bb9057a2fe472a44184346a5/comments","commit":{"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/8e7583b4c691dc44bb9057a2fe472a44184346a5","author":{"date":"2018-05-07T16:50:29.000+08:00","name":"Sijie Guo","email":"sijie@apache.org"},"committer":{"date":"2018-05-07T16:50:29.000+08:00","name":"Sijie Guo","email":"sijie@apache.org"},"message":"[TABLE SERVICE] a zk based storage container controller\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nThe original storage container \"controller\" was written in helix. The helix controller's placement is kind of not assuming any properties of shared storage. however the table service is leverage bookkeeper's as its segment/log store. the table service is built in a more `stateless` way, where a storage container can be moved between servers in a much lightweight way.\n\nAlso helix codebase is a bit large, if we eventually going to eliminate zookeeper, the cost of switching it off helix will be much expensive. so this PR is introducing a simple zk based controller for assigning storage containers to servers.\n\n*Solution*\n\nIn this zk base solution, it is comprised of 3 parts: server registration, cluster & storage controller, storage container manager.\n\n**registration**\n\nthis solution leverages existing registration client/manager interfaces. so each storage server registers itself under `/stream/servers/available`.\n\n**cluster & storage controller**\n\nA storage server is elected as a the leader, which runs a ClusterController. The cluster controller reads cluster metadata from zookeeper (the cluster metadata includes like how many containers available in the cluster), and use a storage controller to compute an assignment plan as the ideal state for container assignment mapping, and then update the assignment mapping to zookeeper under `/stream/assignment`.\n\n**storage container manager**\n\nEach storage server runs a storage container manager, which watches the assignment plan in zookeeper. The cluster controller updates the assignment plan. Once it receives watches/updates from the assignment plan that computed by cluster controller, the storage container manager will align itself to the ideal assignment map by starting/stopping storage containers.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1392 from sijie/table_service_manager","tree":{"url":"https://api.github.com/repos/apache/bookkeeper/git/trees/2745829fedc824afd4e19959ff902087fe8fa9aa","sha":"2745829fedc824afd4e19959ff902087fe8fa9aa"},"comment_count":0},"author":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"committer":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"parents":[{"url":"https://api.github.com/repos/apache/bookkeeper/commits/0ccde17214168ec1f87741d1053ef66ce2344fff","html_url":"https://github.com/apache/bookkeeper/commit/0ccde17214168ec1f87741d1053ef66ce2344fff","sha":"0ccde17214168ec1f87741d1053ef66ce2344fff"}],"repository":{"id":1575956,"name":"bookkeeper","full_name":"apache/bookkeeper","owner":{"login":"apache","id":47359,"avatar_url":"https://avatars0.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/apache/bookkeeper","description":"Apache Bookkeeper","fork":false,"url":"https://api.github.com/repos/apache/bookkeeper","forks_url":"https://api.github.com/repos/apache/bookkeeper/forks","keys_url":"https://api.github.com/repos/apache/bookkeeper/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/bookkeeper/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/bookkeeper/teams","hooks_url":"https://api.github.com/repos/apache/bookkeeper/hooks","issue_events_url":"https://api.github.com/repos/apache/bookkeeper/issues/events{/number}","events_url":"https://api.github.com/repos/apache/bookkeeper/events","assignees_url":"https://api.github.com/repos/apache/bookkeeper/assignees{/user}","branches_url":"https://api.github.com/repos/apache/bookkeeper/branches{/branch}","tags_url":"https://api.github.com/repos/apache/bookkeeper/tags","blobs_url":"https://api.github.com/repos/apache/bookkeeper/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/bookkeeper/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/bookkeeper/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/bookkeeper/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/bookkeeper/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/bookkeeper/languages","stargazers_url":"https://api.github.com/repos/apache/bookkeeper/stargazers","contributors_url":"https://api.github.com/repos/apache/bookkeeper/contributors","subscribers_url":"https://api.github.com/repos/apache/bookkeeper/subscribers","subscription_url":"https://api.github.com/repos/apache/bookkeeper/subscription","commits_url":"https://api.github.com/repos/apache/bookkeeper/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/bookkeeper/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/bookkeeper/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/bookkeeper/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/{+path}","compare_url":"https://api.github.com/repos/apache/bookkeeper/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/bookkeeper/merges","archive_url":"https://api.github.com/repos/apache/bookkeeper/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/bookkeeper/downloads","issues_url":"https://api.github.com/repos/apache/bookkeeper/issues{/number}","pulls_url":"https://api.github.com/repos/apache/bookkeeper/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/bookkeeper/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/bookkeeper/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/bookkeeper/labels{/name}","releases_url":"https://api.github.com/repos/apache/bookkeeper/releases{/id}","deployments_url":"https://api.github.com/repos/apache/bookkeeper/deployments"},"score":20.13469},{"url":"https://api.github.com/repos/apache/bookkeeper/commits/2edcaa60303270152991307260846c201c57d9b5","sha":"2edcaa60303270152991307260846c201c57d9b5","html_url":"https://github.com/apache/bookkeeper/commit/2edcaa60303270152991307260846c201c57d9b5","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/2edcaa60303270152991307260846c201c57d9b5/comments","commit":{"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/2edcaa60303270152991307260846c201c57d9b5","author":{"date":"2018-04-25T02:13:28.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"committer":{"date":"2018-04-25T02:13:28.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"message":"[TABLE SERVICE] Dlog based checkpoint store\n\n*Motivation*\n\nCurrently the table range stores are using local filesystem as a checkpoint store. It is okay for running as standalone mode.\nBut it doesn't work to run in a distributed mode. This change is introducing a dlog based checkpoint store to make sure all\nthe sst files of table ranges are durably checkpointed into bookkeeper itself.\n\n*Solution*\n\nIntroduced a dlog based checkpoint store.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1366 from sijie/dlog_checkpoint_manager","tree":{"url":"https://api.github.com/repos/apache/bookkeeper/git/trees/e97c35b9294522e015a0f785f903eb0e03903742","sha":"e97c35b9294522e015a0f785f903eb0e03903742"},"comment_count":0},"author":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"committer":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"parents":[{"url":"https://api.github.com/repos/apache/bookkeeper/commits/82ad464d3b40e0f69e55556ae15ad06f29ec5003","html_url":"https://github.com/apache/bookkeeper/commit/82ad464d3b40e0f69e55556ae15ad06f29ec5003","sha":"82ad464d3b40e0f69e55556ae15ad06f29ec5003"}],"repository":{"id":1575956,"name":"bookkeeper","full_name":"apache/bookkeeper","owner":{"login":"apache","id":47359,"avatar_url":"https://avatars0.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/apache/bookkeeper","description":"Apache Bookkeeper","fork":false,"url":"https://api.github.com/repos/apache/bookkeeper","forks_url":"https://api.github.com/repos/apache/bookkeeper/forks","keys_url":"https://api.github.com/repos/apache/bookkeeper/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/bookkeeper/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/bookkeeper/teams","hooks_url":"https://api.github.com/repos/apache/bookkeeper/hooks","issue_events_url":"https://api.github.com/repos/apache/bookkeeper/issues/events{/number}","events_url":"https://api.github.com/repos/apache/bookkeeper/events","assignees_url":"https://api.github.com/repos/apache/bookkeeper/assignees{/user}","branches_url":"https://api.github.com/repos/apache/bookkeeper/branches{/branch}","tags_url":"https://api.github.com/repos/apache/bookkeeper/tags","blobs_url":"https://api.github.com/repos/apache/bookkeeper/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/bookkeeper/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/bookkeeper/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/bookkeeper/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/bookkeeper/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/bookkeeper/languages","stargazers_url":"https://api.github.com/repos/apache/bookkeeper/stargazers","contributors_url":"https://api.github.com/repos/apache/bookkeeper/contributors","subscribers_url":"https://api.github.com/repos/apache/bookkeeper/subscribers","subscription_url":"https://api.github.com/repos/apache/bookkeeper/subscription","commits_url":"https://api.github.com/repos/apache/bookkeeper/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/bookkeeper/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/bookkeeper/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/bookkeeper/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/{+path}","compare_url":"https://api.github.com/repos/apache/bookkeeper/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/bookkeeper/merges","archive_url":"https://api.github.com/repos/apache/bookkeeper/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/bookkeeper/downloads","issues_url":"https://api.github.com/repos/apache/bookkeeper/issues{/number}","pulls_url":"https://api.github.com/repos/apache/bookkeeper/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/bookkeeper/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/bookkeeper/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/bookkeeper/labels{/name}","releases_url":"https://api.github.com/repos/apache/bookkeeper/releases{/id}","deployments_url":"https://api.github.com/repos/apache/bookkeeper/deployments"},"score":20.20831},{"url":"https://api.github.com/repos/apache/bookkeeper/commits/ed3b0105d0e1adbb118641cc39f886659d140361","sha":"ed3b0105d0e1adbb118641cc39f886659d140361","html_url":"https://github.com/apache/bookkeeper/commit/ed3b0105d0e1adbb118641cc39f886659d140361","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/ed3b0105d0e1adbb118641cc39f886659d140361/comments","commit":{"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/ed3b0105d0e1adbb118641cc39f886659d140361","author":{"date":"2018-04-25T02:09:36.000-07:00","name":"Nicolas Michael","email":"nmichael@salesforce.com"},"committer":{"date":"2018-04-25T02:09:36.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"message":"Issue #1363: Fast and Garbage-Free Codahale Statistics Timers\n\nThis change introduces a new Codahale-based metrics provider \"FastCodahaleMetricsProvider\" in the codahale-metrics-provider artifact, which can be activated through the \"statsProviderClass\" config parameter (no changes made to the existing \"CodahaleMetricsProvider\"). This new \"FastCodahaleMetricsProvider\" brings a new timer implementation \"FastTimer\", which extends Codahale's Timer class, provides an identical API, is registered in Codahale's timer registry, and can be queried through the existing JettyServices implementation. FastTimer provides similar functionality as Codahale's default timer, but is significantly faster and (nearly) garbage free.\n\nThe improvements of FastTimer over Codahale default Timer with ExponentiallyDecayingReservoirs are:\n* entirely garbage-free Timer updates (only snapshot creations when querying a timer allocate a small number of Java objects)\n* 3x faster Timer updates (i.e. 3x shorter code-path to update a timer)\n* half the memory footprint (in default configuration)\n\nFastTimer reduces GC pause times in our experiments as described in Issue 1363 by half (same as entirely deactivating all timers).\n\nThe primary functional differences between FastTimer and Codahale default Timer with ExponentiallyDecayingReservoirs are:\n* FastTimer keeps values for a fixed, configurable time period (default: 60 seconds) rather than exponentially decaying them\n* FastTimer bucketizes event times rather than storing discrete values. Percentile values depend on the bucket resolution.\n\nDesign Considerations\n---------------------\n\nThe design goals of this timer implementation are for it to be\n - fast (i.e. few instructions to update a timer)\n - scalable (i.e. little synchronization cost for concurrent timer updates)\n - garbage-free for timer updates (i.e. no object allocation for timer updates)\n - space-efficient (i.e. as little memory footprint as possible while achieving first three goals)\n - provide similar functionality as Codahale's default timers with ExponentiallyDecayingReservoirs\n\nThis implementation provides rate and response times over a configurable sliding time window. Data\nis stored in upfront allocated circular arrays, in which each array element holds data\nfor one second. Data is overwritten in a circular fashion without the allocation of new data\nstructures and is therefore garbage-free for all timer updates.\n\nThis implementation does not store individual response times, but instead allocates bucketized counters\nupfront, which are incremented for any event falling into a particular response time bucket. A\nfine-grained bucket definition (intended for capturing successsful events) and a coarse-grained\nbucket definition (intended to capture failure or timed-out events) are provided.\n\nTo improve scalability of concurrent timer updates, most data structures are replicated HASH_SIZE\ntimes, and calling threads updating a timer are hashed to individual instances. Performance tests\n(see below) have shown that this implementation is light-weight enough to achieve slightly better\nscalability than Codahale's default timers even without hashing, and can further improve scalability\nif hashing is used.\n\nTrading off performance and scalability vs. memory footprint, we need to be conservative in the hash\nsize we chose. Different flavors of this timer implementation have been evaluated using JMH\nmicro-benchmarks (see microbenchmarks/src/main/java/org/apache/bookkeeper/stats/TimerBenchmark.java),\ncomparing implementations of FastTimer with a time window of 60 seconds and\n- (DEV1)   a HASH_SIZE of 3 for all data structures (meters, counters, min/max, and response time buckets)\n- (DEV2)   a HASH_SIZE of 1 for all data structures (meters, counters, min/max, and response time buckets)\n- (FINAL)  a HASH_SIZE of 3 for meters, counters, min/max, and no hashing for response time buckets\nto the default timer implementation\n- (BASE-E) Codahale Timer with ExponentiallyDecayingReservoir (default as used by bookkeeper code)\n- (BASE-T) Codahale Timer with SlidingTimeWindowReservoir configured to 60 seconds\n- (BASE-S) Codahale Timer with SlidingWindowReservoir configured to hold 100,000 events.\n\nBased on results below, implementation (FINAL) was chosen as the final FastTimer implementation, as it\nachieves nearly the same throughput as (DEV1) at nearly the same memory footprint as (DEV2), and\nultimately achieves roughly 3x higher throughput and scalability that Codahale's default implementation\nat around half the memory footprint.\n\nThe following results have been collected on an eight core x86 server running at 3.2 GHz (updated\ntimers are shared across 4 threads):\n\n```\nConfig   Timer Impl             Timers   Threads      ops/ms   Alloc B/op   Kb/TimerPair\n----------------------------------------------------------------------------------------\n DEV1    FastTimer (Hash 3)          1         4   11487.904        0                253\n DEV1    FastTimer (Hash 3)         10         4   22621.702        0                253\n DEV1    FastTimer (Hash 3)        100         4   21781.319        0                253\n DEV2    FastTimer (Hash 1)          1         4    5138.143        0                 88\n DEV2    FastTimer (Hash 1)         10         4   22902.195        0                 88\n DEV2    FastTimer (Hash 1)        100         4   19173.085        0                 88\n FINAL   FastTimer (Hash 3/1)        1         4    9291.002        0                 99\n FINAL   FastTimer (Hash 3/1)       10         4   16379.940        0                 99\n FINAL   FastTimer (Hash 3/1)      100         4   16751.020        0                 99\n BASE-E  CodahaleTimer               1         4    3845.187       82.609            189\n BASE-E  CodahaleTimer              10         4    7262.445       35.035            189\n BASE-E  CodahaleTimer             100         4    7051.77        32.843            189\n BASE-T  CodahaleTimer/TimeWindow    1         4     102.479       90.851            174\n BASE-T  CodahaleTimer/TimeWindow   10         4      68.852       84.812            174\n BASE-T  CodahaleTimer/TimeWindow  100         4     153.444      136.436            174\n BASE-S  CodahaleTimer/SlidingWdw    1         4    4670.543        0               2103\n BASE-S  CodahaleTimer/SlidingWdw   10         4   13696.168        0               2103\n BASE-S  CodahaleTimer/SlidingWdw  100         4   12541.936        0               2103\n```\n\n- ops/ms is the number of timer updates per millisecond.\n- Alloc B/op is the number of bytes allocated per timer update\n- Kb/TimerPair is the heap footprint per pair of timers (one with fine-grained, one with coarse-grained buckets)\n\nThe following test results include snapshot creation every 109 timer updates (typically, we would assume\nsnapshot creation to be much less frequent), and show that also with snapshots in the mix, FastTimer outperforms\nCodahale default Timers both with respect to throughput and scalability as well as object allocation:\n\n```\nConfig   Timer Impl             Timers   Threads      ops/ms   Alloc B/op\n-------------------------------------------------------------------------\n FINAL   FastTimer (Hash 3/1)        1         4    1569.953       23.707\n FINAL   FastTimer (Hash 3/1)       10         4    7316.794       24.073\n FINAL   FastTimer (Hash 3/1)      100         4    6498.215       24.073\n BASE-E  CodahaleTimer               1         4     246.953      481.771\n BASE-E  CodahaleTimer              10         4    1989.134      476.807\n BASE-E  CodahaleTimer             100         4    1514.729      468.624\n BASE-T  CodahaleTimer/TimeWindow    1         4       6.063    43795.810\n BASE-T  CodahaleTimer/TimeWindow   10         4      44.651    33916.315\n BASE-T  CodahaleTimer/TimeWindow  100         4     180.431    12330.939\n BASE-S  CodahaleTimer/SlidingWdw    1         4      17.439    14683.756\n BASE-S  CodahaleTimer/SlidingWdw   10         4     107.257    14683.745\n BASE-S  CodahaleTimer/SlidingWdw  100         4     236.538     9767.106\n```\n\nUnfortunately Codahale does not have a Timer interface we can implement, and some Codahale\nbase classes are assuming instances of Timer (for example, our JettyServices instantiate a\nCodahale MetricsServlet, which instantiates a Codahale MetricsModule, which only serializes\ntimers that are instances of Timer class into the json output stream). Unless we wanted to\nreimplement or override all these base classes, we can't just implement Codahale's Metered and Sampling\ninterfaces. Instead we have to extend its Timer class, even though we're not using any of its\ninherited functionality or data structures. The inherited (unused) member variables of Codahale Timer\nconsume slightly less than 512 byte per FastTimer (measured around 425 byte in Codahale 3.1).\nAbove memory footprint results include ~ 1 kb of inherited (unused) data structures, which comprise\naround 1% of FastTimer's overall memory footprint.\n\nIn terms of functionality, FastTimer provides the same functionality as Codahale's timers\n(in default configuration with ExponentiallyDecayingReservoirs), with the following exceptions:\n- Statistics are kept for a fixed amount of time (rather than exponentially decayed), by\n  default 60 seconds. As a consequence, getMeanRate(), getOneMinuteRate(),  getFiveMinuteRate()\n  and getFifteenMinuteRate() all return the same value if FastTimer is configured to use a\n  60 second time window.\n- FastTimer and FastSnapshot only record bucketized instead of discrete response times. As a\n  consequence, the accuracy of percentiles depends on bucket granularity. FastSnapshot also\n  can't return discrete values: getValues() returns an empty array, and size returns 0.\n\nAuthor: Nicolas Michael <nmichael@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1364 from nicmichael/FastTimer, closes #1363","tree":{"url":"https://api.github.com/repos/apache/bookkeeper/git/trees/67fc8b3f65c5e3e954e781e35b977023b89c3aa8","sha":"67fc8b3f65c5e3e954e781e35b977023b89c3aa8"},"comment_count":0},"author":{"login":"nicmichael","id":27270046,"avatar_url":"https://avatars2.githubusercontent.com/u/27270046?v=4","gravatar_id":"","url":"https://api.github.com/users/nicmichael","html_url":"https://github.com/nicmichael","followers_url":"https://api.github.com/users/nicmichael/followers","following_url":"https://api.github.com/users/nicmichael/following{/other_user}","gists_url":"https://api.github.com/users/nicmichael/gists{/gist_id}","starred_url":"https://api.github.com/users/nicmichael/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicmichael/subscriptions","organizations_url":"https://api.github.com/users/nicmichael/orgs","repos_url":"https://api.github.com/users/nicmichael/repos","events_url":"https://api.github.com/users/nicmichael/events{/privacy}","received_events_url":"https://api.github.com/users/nicmichael/received_events","type":"User","site_admin":false},"committer":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"parents":[{"url":"https://api.github.com/repos/apache/bookkeeper/commits/e021ac31cb1acb8de6d4161a618e76127d04d1c8","html_url":"https://github.com/apache/bookkeeper/commit/e021ac31cb1acb8de6d4161a618e76127d04d1c8","sha":"e021ac31cb1acb8de6d4161a618e76127d04d1c8"}],"repository":{"id":1575956,"name":"bookkeeper","full_name":"apache/bookkeeper","owner":{"login":"apache","id":47359,"avatar_url":"https://avatars0.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/apache/bookkeeper","description":"Apache Bookkeeper","fork":false,"url":"https://api.github.com/repos/apache/bookkeeper","forks_url":"https://api.github.com/repos/apache/bookkeeper/forks","keys_url":"https://api.github.com/repos/apache/bookkeeper/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/bookkeeper/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/bookkeeper/teams","hooks_url":"https://api.github.com/repos/apache/bookkeeper/hooks","issue_events_url":"https://api.github.com/repos/apache/bookkeeper/issues/events{/number}","events_url":"https://api.github.com/repos/apache/bookkeeper/events","assignees_url":"https://api.github.com/repos/apache/bookkeeper/assignees{/user}","branches_url":"https://api.github.com/repos/apache/bookkeeper/branches{/branch}","tags_url":"https://api.github.com/repos/apache/bookkeeper/tags","blobs_url":"https://api.github.com/repos/apache/bookkeeper/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/bookkeeper/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/bookkeeper/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/bookkeeper/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/bookkeeper/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/bookkeeper/languages","stargazers_url":"https://api.github.com/repos/apache/bookkeeper/stargazers","contributors_url":"https://api.github.com/repos/apache/bookkeeper/contributors","subscribers_url":"https://api.github.com/repos/apache/bookkeeper/subscribers","subscription_url":"https://api.github.com/repos/apache/bookkeeper/subscription","commits_url":"https://api.github.com/repos/apache/bookkeeper/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/bookkeeper/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/bookkeeper/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/bookkeeper/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/{+path}","compare_url":"https://api.github.com/repos/apache/bookkeeper/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/bookkeeper/merges","archive_url":"https://api.github.com/repos/apache/bookkeeper/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/bookkeeper/downloads","issues_url":"https://api.github.com/repos/apache/bookkeeper/issues{/number}","pulls_url":"https://api.github.com/repos/apache/bookkeeper/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/bookkeeper/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/bookkeeper/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/bookkeeper/labels{/name}","releases_url":"https://api.github.com/repos/apache/bookkeeper/releases{/id}","deployments_url":"https://api.github.com/repos/apache/bookkeeper/deployments"},"score":19.41605},{"url":"https://api.github.com/repos/apache/bookkeeper/commits/e021ac31cb1acb8de6d4161a618e76127d04d1c8","sha":"e021ac31cb1acb8de6d4161a618e76127d04d1c8","html_url":"https://github.com/apache/bookkeeper/commit/e021ac31cb1acb8de6d4161a618e76127d04d1c8","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/e021ac31cb1acb8de6d4161a618e76127d04d1c8/comments","commit":{"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/e021ac31cb1acb8de6d4161a618e76127d04d1c8","author":{"date":"2018-04-24T12:17:32.000+02:00","name":"Nicolas Michael","email":"nmichael@salesforce.com"},"committer":{"date":"2018-04-24T12:17:32.000+02:00","name":"Enrico Olivelli","email":"eolivelli@apache.org"},"message":"Issue #791: Eliminate byte[] copies in AddEntry code path\n\nThe AddEntry code path in Bookkeeper Client performs several copies of the send buffer before sending it out to bookies, which not only costs CPU cycles for array copying, but also drives up object allocation rate and thus increases young GC frequency.\n\nCurrently, the send buffer is prepared by DigestManager.computeDigestAndPackageForSending(), which wraps the netty ByteBuf containing the data together with a (direct) header buffer into a ByteBufList. So far, we haven't yet allocated or copied any new buffers. But in order to send the buffer to the bookies, PendingAddOp.safeRun() will invoke sendWriteRequest() for each bookie in the write set, which will eventually invoke PerChannelBookieClient.addEntry() for each bookie. In here, we are now allocating two new byte[] and copying the buffer twice per bookie for V3 protocol with protobuf:\n    byte[] toSendArray = toSend.toArray();      // 1st byte[] allocation and copy\n    .setBody(ByteString.copyFrom(toSendArray)); // 2nd byte[] allocation and copy\nIf for example we're using a write set size of 3, then we allocate 6 byte arrays and copy the same buffer 6 times.\n\nAll 6 copies can be eliminated if DigestManager.computeDigestAndPackageForSending() would return a ByteBuf (or ByteBufList) that is backed by an array, which we can access and use without further copying it. PerChannelBookieClient.addEntry() could then wrap this array into a protobuf ByteString without performing any additional copies.\n\nThis change eliminates all byte[] allocations and copies in PCBC by:\n1. allocating a new (pooled) array-backed heap ByteBuf for header, digest, and data in DigestManager.computeDigestAndPackageForSending()\n2. copying the data payload into this newly allocated ByteBuf and returning it wrapped into a ByteBufList of size 1 (instead of header + body separately)\n3. enhancing ByteBufList to give access to the underlying array if it consists of only a single ByteBuf that's backed by an array\n4. extracting the underlying array in PerChannelBookieClient.addEntry() from ByteBufList and wrapping it into protobuf ByteString without copying it.\n\nWith this change, no more object allocations are required in this code path. DigestManager uses a pooled array (1). We're adding one arraycopy in (2) compared to the original code path, trading this against the allocations and copies we save later on.. Later steps, in particular step (4), is free of object allocation and array copies.\nAs a result, the object allocation rate in the AddEntry code path is reduced significantly. In case of a write set size of 3, it is reduced from 6 to 0. This translates into much less frequent young generation garbage collections (in my experiments with write-heavy workload by ~4x overall).\n\nAuthor: Nicolas Michael <nmichael@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1361 from nicmichael/AddEntryNoCopy, closes #791","tree":{"url":"https://api.github.com/repos/apache/bookkeeper/git/trees/a3e09e9c0380eb07dfdfef855d02bbb976f8ad31","sha":"a3e09e9c0380eb07dfdfef855d02bbb976f8ad31"},"comment_count":0},"author":{"login":"nicmichael","id":27270046,"avatar_url":"https://avatars2.githubusercontent.com/u/27270046?v=4","gravatar_id":"","url":"https://api.github.com/users/nicmichael","html_url":"https://github.com/nicmichael","followers_url":"https://api.github.com/users/nicmichael/followers","following_url":"https://api.github.com/users/nicmichael/following{/other_user}","gists_url":"https://api.github.com/users/nicmichael/gists{/gist_id}","starred_url":"https://api.github.com/users/nicmichael/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicmichael/subscriptions","organizations_url":"https://api.github.com/users/nicmichael/orgs","repos_url":"https://api.github.com/users/nicmichael/repos","events_url":"https://api.github.com/users/nicmichael/events{/privacy}","received_events_url":"https://api.github.com/users/nicmichael/received_events","type":"User","site_admin":false},"committer":null,"parents":[{"url":"https://api.github.com/repos/apache/bookkeeper/commits/e9aeddd89623bf1cd0c9ecb8ef200c7a3dd47f95","html_url":"https://github.com/apache/bookkeeper/commit/e9aeddd89623bf1cd0c9ecb8ef200c7a3dd47f95","sha":"e9aeddd89623bf1cd0c9ecb8ef200c7a3dd47f95"}],"repository":{"id":1575956,"name":"bookkeeper","full_name":"apache/bookkeeper","owner":{"login":"apache","id":47359,"avatar_url":"https://avatars0.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/apache/bookkeeper","description":"Apache Bookkeeper","fork":false,"url":"https://api.github.com/repos/apache/bookkeeper","forks_url":"https://api.github.com/repos/apache/bookkeeper/forks","keys_url":"https://api.github.com/repos/apache/bookkeeper/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/bookkeeper/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/bookkeeper/teams","hooks_url":"https://api.github.com/repos/apache/bookkeeper/hooks","issue_events_url":"https://api.github.com/repos/apache/bookkeeper/issues/events{/number}","events_url":"https://api.github.com/repos/apache/bookkeeper/events","assignees_url":"https://api.github.com/repos/apache/bookkeeper/assignees{/user}","branches_url":"https://api.github.com/repos/apache/bookkeeper/branches{/branch}","tags_url":"https://api.github.com/repos/apache/bookkeeper/tags","blobs_url":"https://api.github.com/repos/apache/bookkeeper/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/bookkeeper/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/bookkeeper/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/bookkeeper/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/bookkeeper/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/bookkeeper/languages","stargazers_url":"https://api.github.com/repos/apache/bookkeeper/stargazers","contributors_url":"https://api.github.com/repos/apache/bookkeeper/contributors","subscribers_url":"https://api.github.com/repos/apache/bookkeeper/subscribers","subscription_url":"https://api.github.com/repos/apache/bookkeeper/subscription","commits_url":"https://api.github.com/repos/apache/bookkeeper/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/bookkeeper/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/bookkeeper/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/bookkeeper/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/{+path}","compare_url":"https://api.github.com/repos/apache/bookkeeper/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/bookkeeper/merges","archive_url":"https://api.github.com/repos/apache/bookkeeper/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/bookkeeper/downloads","issues_url":"https://api.github.com/repos/apache/bookkeeper/issues{/number}","pulls_url":"https://api.github.com/repos/apache/bookkeeper/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/bookkeeper/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/bookkeeper/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/bookkeeper/labels{/name}","releases_url":"https://api.github.com/repos/apache/bookkeeper/releases{/id}","deployments_url":"https://api.github.com/repos/apache/bookkeeper/deployments"},"score":19.459072},{"url":"https://api.github.com/repos/apache/bookkeeper/commits/7fe8427bbd00603ef07f6846f27a6cc4f2fa1376","sha":"7fe8427bbd00603ef07f6846f27a6cc4f2fa1376","html_url":"https://github.com/apache/bookkeeper/commit/7fe8427bbd00603ef07f6846f27a6cc4f2fa1376","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/7fe8427bbd00603ef07f6846f27a6cc4f2fa1376/comments","commit":{"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/7fe8427bbd00603ef07f6846f27a6cc4f2fa1376","author":{"date":"2018-04-19T00:09:12.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"committer":{"date":"2018-04-19T00:09:12.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"message":"ISSUE #1246: Scripting the whole release procedure\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nReleasing bookkeeper becomes tricky after introducing `circe-checksum`, since we need to ensure linux jni library is shipped as part of `circe-checksum`.\n\n*Solution*\n\n- switch to use docker for generating bookkeeper release\n- scripting the whole release procedure as many as possible\n\nMaster Issue: #1246\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1329 from sijie/release_scripts, closes #1246","tree":{"url":"https://api.github.com/repos/apache/bookkeeper/git/trees/8297779ebb392747dd52407d67591caf08de3720","sha":"8297779ebb392747dd52407d67591caf08de3720"},"comment_count":0},"author":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"committer":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"parents":[{"url":"https://api.github.com/repos/apache/bookkeeper/commits/c21c53bd7de8341d1e0b5c3c8d5d2e1c33857f93","html_url":"https://github.com/apache/bookkeeper/commit/c21c53bd7de8341d1e0b5c3c8d5d2e1c33857f93","sha":"c21c53bd7de8341d1e0b5c3c8d5d2e1c33857f93"}],"repository":{"id":1575956,"name":"bookkeeper","full_name":"apache/bookkeeper","owner":{"login":"apache","id":47359,"avatar_url":"https://avatars0.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/apache/bookkeeper","description":"Apache Bookkeeper","fork":false,"url":"https://api.github.com/repos/apache/bookkeeper","forks_url":"https://api.github.com/repos/apache/bookkeeper/forks","keys_url":"https://api.github.com/repos/apache/bookkeeper/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/bookkeeper/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/bookkeeper/teams","hooks_url":"https://api.github.com/repos/apache/bookkeeper/hooks","issue_events_url":"https://api.github.com/repos/apache/bookkeeper/issues/events{/number}","events_url":"https://api.github.com/repos/apache/bookkeeper/events","assignees_url":"https://api.github.com/repos/apache/bookkeeper/assignees{/user}","branches_url":"https://api.github.com/repos/apache/bookkeeper/branches{/branch}","tags_url":"https://api.github.com/repos/apache/bookkeeper/tags","blobs_url":"https://api.github.com/repos/apache/bookkeeper/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/bookkeeper/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/bookkeeper/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/bookkeeper/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/bookkeeper/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/bookkeeper/languages","stargazers_url":"https://api.github.com/repos/apache/bookkeeper/stargazers","contributors_url":"https://api.github.com/repos/apache/bookkeeper/contributors","subscribers_url":"https://api.github.com/repos/apache/bookkeeper/subscribers","subscription_url":"https://api.github.com/repos/apache/bookkeeper/subscription","commits_url":"https://api.github.com/repos/apache/bookkeeper/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/bookkeeper/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/bookkeeper/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/bookkeeper/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/{+path}","compare_url":"https://api.github.com/repos/apache/bookkeeper/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/bookkeeper/merges","archive_url":"https://api.github.com/repos/apache/bookkeeper/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/bookkeeper/downloads","issues_url":"https://api.github.com/repos/apache/bookkeeper/issues{/number}","pulls_url":"https://api.github.com/repos/apache/bookkeeper/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/bookkeeper/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/bookkeeper/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/bookkeeper/labels{/name}","releases_url":"https://api.github.com/repos/apache/bookkeeper/releases{/id}","deployments_url":"https://api.github.com/repos/apache/bookkeeper/deployments"},"score":20.78658},{"url":"https://api.github.com/repos/apache/bookkeeper/commits/1242e3757c3dffd3c846787756c49779aee31d13","sha":"1242e3757c3dffd3c846787756c49779aee31d13","html_url":"https://github.com/apache/bookkeeper/commit/1242e3757c3dffd3c846787756c49779aee31d13","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/1242e3757c3dffd3c846787756c49779aee31d13/comments","commit":{"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/1242e3757c3dffd3c846787756c49779aee31d13","author":{"date":"2018-04-16T23:56:29.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"committer":{"date":"2018-04-16T23:56:29.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"message":"Provide memory & gc options in bookkeeper script\n\nDescriptions of the changes in this PR:\n\nIt is convenient to provide `MEM_OPTS` and `GC_OPTS` in bookkeeper script and bkenv.sh to allow overriding jvm settings through.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1342 from sijie/gc_settings","tree":{"url":"https://api.github.com/repos/apache/bookkeeper/git/trees/e0ef43ae427d4e59a6ef70a5cc23820ebd882010","sha":"e0ef43ae427d4e59a6ef70a5cc23820ebd882010"},"comment_count":0},"author":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"committer":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"parents":[{"url":"https://api.github.com/repos/apache/bookkeeper/commits/7f010d29cbef0cbdf75b472df28cd9ea85f5c419","html_url":"https://github.com/apache/bookkeeper/commit/7f010d29cbef0cbdf75b472df28cd9ea85f5c419","sha":"7f010d29cbef0cbdf75b472df28cd9ea85f5c419"}],"repository":{"id":1575956,"name":"bookkeeper","full_name":"apache/bookkeeper","owner":{"login":"apache","id":47359,"avatar_url":"https://avatars0.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/apache/bookkeeper","description":"Apache Bookkeeper","fork":false,"url":"https://api.github.com/repos/apache/bookkeeper","forks_url":"https://api.github.com/repos/apache/bookkeeper/forks","keys_url":"https://api.github.com/repos/apache/bookkeeper/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/bookkeeper/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/bookkeeper/teams","hooks_url":"https://api.github.com/repos/apache/bookkeeper/hooks","issue_events_url":"https://api.github.com/repos/apache/bookkeeper/issues/events{/number}","events_url":"https://api.github.com/repos/apache/bookkeeper/events","assignees_url":"https://api.github.com/repos/apache/bookkeeper/assignees{/user}","branches_url":"https://api.github.com/repos/apache/bookkeeper/branches{/branch}","tags_url":"https://api.github.com/repos/apache/bookkeeper/tags","blobs_url":"https://api.github.com/repos/apache/bookkeeper/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/bookkeeper/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/bookkeeper/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/bookkeeper/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/bookkeeper/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/bookkeeper/languages","stargazers_url":"https://api.github.com/repos/apache/bookkeeper/stargazers","contributors_url":"https://api.github.com/repos/apache/bookkeeper/contributors","subscribers_url":"https://api.github.com/repos/apache/bookkeeper/subscribers","subscription_url":"https://api.github.com/repos/apache/bookkeeper/subscription","commits_url":"https://api.github.com/repos/apache/bookkeeper/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/bookkeeper/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/bookkeeper/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/bookkeeper/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/{+path}","compare_url":"https://api.github.com/repos/apache/bookkeeper/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/bookkeeper/merges","archive_url":"https://api.github.com/repos/apache/bookkeeper/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/bookkeeper/downloads","issues_url":"https://api.github.com/repos/apache/bookkeeper/issues{/number}","pulls_url":"https://api.github.com/repos/apache/bookkeeper/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/bookkeeper/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/bookkeeper/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/bookkeeper/labels{/name}","releases_url":"https://api.github.com/repos/apache/bookkeeper/releases{/id}","deployments_url":"https://api.github.com/repos/apache/bookkeeper/deployments"},"score":21.003962},{"url":"https://api.github.com/repos/apache/bookkeeper/commits/51c26dcf3446ef0bf2bc7c753e5d188e29123ae8","sha":"51c26dcf3446ef0bf2bc7c753e5d188e29123ae8","html_url":"https://github.com/apache/bookkeeper/commit/51c26dcf3446ef0bf2bc7c753e5d188e29123ae8","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/51c26dcf3446ef0bf2bc7c753e5d188e29123ae8/comments","commit":{"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/51c26dcf3446ef0bf2bc7c753e5d188e29123ae8","author":{"date":"2018-04-15T15:07:38.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"committer":{"date":"2018-04-15T15:07:38.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"message":"Only check ipv6 binding when /sbin/sysctl exists\n\nDescriptions of the changes in this PR:\n\n*Problem*\n\nIf bookkeeper is included in some slim docker images, sysctl might not exists at all.\nIt would fail bookie to start.\n\n*Solution*\n\nOnly check ipv6 binding when /sbin/sysctl exists\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1340 from sijie/disable_ipv6_binding","tree":{"url":"https://api.github.com/repos/apache/bookkeeper/git/trees/12347e0e2f2a8e6c03590cdfc5263f69ec516d14","sha":"12347e0e2f2a8e6c03590cdfc5263f69ec516d14"},"comment_count":0},"author":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"committer":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"parents":[{"url":"https://api.github.com/repos/apache/bookkeeper/commits/c3e96a76be35a0adb6f700491dd0a8786d5b2957","html_url":"https://github.com/apache/bookkeeper/commit/c3e96a76be35a0adb6f700491dd0a8786d5b2957","sha":"c3e96a76be35a0adb6f700491dd0a8786d5b2957"}],"repository":{"id":1575956,"name":"bookkeeper","full_name":"apache/bookkeeper","owner":{"login":"apache","id":47359,"avatar_url":"https://avatars0.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/apache/bookkeeper","description":"Apache Bookkeeper","fork":false,"url":"https://api.github.com/repos/apache/bookkeeper","forks_url":"https://api.github.com/repos/apache/bookkeeper/forks","keys_url":"https://api.github.com/repos/apache/bookkeeper/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/bookkeeper/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/bookkeeper/teams","hooks_url":"https://api.github.com/repos/apache/bookkeeper/hooks","issue_events_url":"https://api.github.com/repos/apache/bookkeeper/issues/events{/number}","events_url":"https://api.github.com/repos/apache/bookkeeper/events","assignees_url":"https://api.github.com/repos/apache/bookkeeper/assignees{/user}","branches_url":"https://api.github.com/repos/apache/bookkeeper/branches{/branch}","tags_url":"https://api.github.com/repos/apache/bookkeeper/tags","blobs_url":"https://api.github.com/repos/apache/bookkeeper/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/bookkeeper/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/bookkeeper/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/bookkeeper/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/bookkeeper/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/bookkeeper/languages","stargazers_url":"https://api.github.com/repos/apache/bookkeeper/stargazers","contributors_url":"https://api.github.com/repos/apache/bookkeeper/contributors","subscribers_url":"https://api.github.com/repos/apache/bookkeeper/subscribers","subscription_url":"https://api.github.com/repos/apache/bookkeeper/subscription","commits_url":"https://api.github.com/repos/apache/bookkeeper/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/bookkeeper/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/bookkeeper/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/bookkeeper/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/{+path}","compare_url":"https://api.github.com/repos/apache/bookkeeper/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/bookkeeper/merges","archive_url":"https://api.github.com/repos/apache/bookkeeper/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/bookkeeper/downloads","issues_url":"https://api.github.com/repos/apache/bookkeeper/issues{/number}","pulls_url":"https://api.github.com/repos/apache/bookkeeper/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/bookkeeper/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/bookkeeper/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/bookkeeper/labels{/name}","releases_url":"https://api.github.com/repos/apache/bookkeeper/releases{/id}","deployments_url":"https://api.github.com/repos/apache/bookkeeper/deployments"},"score":20.074478},{"url":"https://api.github.com/repos/apache/bookkeeper/commits/3d39435d316bc05e64c4247aeb8455bcd2a96989","sha":"3d39435d316bc05e64c4247aeb8455bcd2a96989","html_url":"https://github.com/apache/bookkeeper/commit/3d39435d316bc05e64c4247aeb8455bcd2a96989","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/3d39435d316bc05e64c4247aeb8455bcd2a96989/comments","commit":{"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/3d39435d316bc05e64c4247aeb8455bcd2a96989","author":{"date":"2018-04-12T16:30:09.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"committer":{"date":"2018-04-12T16:30:09.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"message":"Use metadata service uri rather than zkServers\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nMetadata service uri is introduced as part of BP-29. However most of the tests and tools are still assuming `zkServers`.\nThis causes a problem if people configures `metadataServiceUri`, some of the admin tools don't actually work.\n\n*Solution*\n\nThis change changes bookkeeper to use `metadataServiceUri` in all the possible places and provides methods to resolve zkServers\nand zkLedgersRootPath from metadata service uri. This ensures:\n\n1) if users configure `metadataServiceUri`, all the tools would work properly.\n2) if users doesn't configure `metadataServiceUri` and still use `zkServers` and `zkLedgersRootPath`, all the tools would still work.\n\n*Changes*\n\nThe main changes are:\n\n- deprecated direct usage of `getZkServers`, `setZkServers`, `getZkLedgersRootPath`, `setZkLedgersRootPath, `getZkAvailablePath` at AbstractConfiguration\n- provide util methods `resolveZkServers` and `resolverZkLedgersRootPath` in `ZkMetadataDriverBase` for resolving zookeeper specific settings from metadata service uri\n- change the tools to use `getMetadataServiceUri`\n- change the tests to use `getMetadataServiceUri` to ensure code coverage\n\n*NOTES*\n\nThere are a few places still using `getZkServers`, `setZkServers`. those are hard to change at this moment.\n\nRelated Issue:\n- #1335\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1336 from sijie/fix_local_bookkeeper","tree":{"url":"https://api.github.com/repos/apache/bookkeeper/git/trees/c16dbd18566adf9a2d71683a493a1ae2b68e4b8d","sha":"c16dbd18566adf9a2d71683a493a1ae2b68e4b8d"},"comment_count":0},"author":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"committer":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"parents":[{"url":"https://api.github.com/repos/apache/bookkeeper/commits/9921613829dba70a2903ee19ddfc4dc757fb39ab","html_url":"https://github.com/apache/bookkeeper/commit/9921613829dba70a2903ee19ddfc4dc757fb39ab","sha":"9921613829dba70a2903ee19ddfc4dc757fb39ab"}],"repository":{"id":1575956,"name":"bookkeeper","full_name":"apache/bookkeeper","owner":{"login":"apache","id":47359,"avatar_url":"https://avatars0.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/apache/bookkeeper","description":"Apache Bookkeeper","fork":false,"url":"https://api.github.com/repos/apache/bookkeeper","forks_url":"https://api.github.com/repos/apache/bookkeeper/forks","keys_url":"https://api.github.com/repos/apache/bookkeeper/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/bookkeeper/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/bookkeeper/teams","hooks_url":"https://api.github.com/repos/apache/bookkeeper/hooks","issue_events_url":"https://api.github.com/repos/apache/bookkeeper/issues/events{/number}","events_url":"https://api.github.com/repos/apache/bookkeeper/events","assignees_url":"https://api.github.com/repos/apache/bookkeeper/assignees{/user}","branches_url":"https://api.github.com/repos/apache/bookkeeper/branches{/branch}","tags_url":"https://api.github.com/repos/apache/bookkeeper/tags","blobs_url":"https://api.github.com/repos/apache/bookkeeper/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/bookkeeper/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/bookkeeper/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/bookkeeper/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/bookkeeper/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/bookkeeper/languages","stargazers_url":"https://api.github.com/repos/apache/bookkeeper/stargazers","contributors_url":"https://api.github.com/repos/apache/bookkeeper/contributors","subscribers_url":"https://api.github.com/repos/apache/bookkeeper/subscribers","subscription_url":"https://api.github.com/repos/apache/bookkeeper/subscription","commits_url":"https://api.github.com/repos/apache/bookkeeper/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/bookkeeper/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/bookkeeper/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/bookkeeper/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/{+path}","compare_url":"https://api.github.com/repos/apache/bookkeeper/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/bookkeeper/merges","archive_url":"https://api.github.com/repos/apache/bookkeeper/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/bookkeeper/downloads","issues_url":"https://api.github.com/repos/apache/bookkeeper/issues{/number}","pulls_url":"https://api.github.com/repos/apache/bookkeeper/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/bookkeeper/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/bookkeeper/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/bookkeeper/labels{/name}","releases_url":"https://api.github.com/repos/apache/bookkeeper/releases{/id}","deployments_url":"https://api.github.com/repos/apache/bookkeeper/deployments"},"score":19.69626},{"url":"https://api.github.com/repos/apache/bookkeeper/commits/71901bcd8bb27257b8ef574353d6a851ff6e56f7","sha":"71901bcd8bb27257b8ef574353d6a851ff6e56f7","html_url":"https://github.com/apache/bookkeeper/commit/71901bcd8bb27257b8ef574353d6a851ff6e56f7","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/71901bcd8bb27257b8ef574353d6a851ff6e56f7/comments","commit":{"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/71901bcd8bb27257b8ef574353d6a851ff6e56f7","author":{"date":"2018-04-09T16:01:23.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"committer":{"date":"2018-04-09T16:01:23.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"message":"Improve \"Failed to resolve network location\" logging\n\nDescriptions of the changes in this PR:\n\n*Problem*\n\nRackware/Region-Aware is using a script based DNS resolver for resolving network topology. If the network topology script is not configured, the DNS resolver will return `null` as network location. It results in using `default-rack` as the network location and log \"Failed to resolve network location\" for each resolution.\n\n*Solution*\n\nIf a script file is not provided, throw a runtime exception. So the rackaware/region-aware placement policy can fallback to use the default-rack resolver. It would avoid the logging flood.\n\n*Result*\n\nBefore this change, it will log following statement for each DNS resolution:\n\n\"Failed to resolve network location\".\n\nAfter this change, it will only log following statement during initialization:\n\n```\nINFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl313] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver.\njava.lang.RuntimeException: No network topology script is found when using script based DNS resolver.\n\tat org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.setConf(ScriptBasedMapping.java:150)\n\tat org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:122)\n\tat org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:306)\n\tat org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:75)\n\tat org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:598)\n\tat org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:490)\n```\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Yiming Zang <yzang2016@gmail.com>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1323 from sijie/improve_dns_resolver_logging","tree":{"url":"https://api.github.com/repos/apache/bookkeeper/git/trees/b8d7fec9cefc4e1f6fa27efd3887c637711eaf78","sha":"b8d7fec9cefc4e1f6fa27efd3887c637711eaf78"},"comment_count":0},"author":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"committer":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"parents":[{"url":"https://api.github.com/repos/apache/bookkeeper/commits/c760c566e7ae98d1d4a7a5892c7414480f0c947a","html_url":"https://github.com/apache/bookkeeper/commit/c760c566e7ae98d1d4a7a5892c7414480f0c947a","sha":"c760c566e7ae98d1d4a7a5892c7414480f0c947a"}],"repository":{"id":1575956,"name":"bookkeeper","full_name":"apache/bookkeeper","owner":{"login":"apache","id":47359,"avatar_url":"https://avatars0.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/apache/bookkeeper","description":"Apache Bookkeeper","fork":false,"url":"https://api.github.com/repos/apache/bookkeeper","forks_url":"https://api.github.com/repos/apache/bookkeeper/forks","keys_url":"https://api.github.com/repos/apache/bookkeeper/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/bookkeeper/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/bookkeeper/teams","hooks_url":"https://api.github.com/repos/apache/bookkeeper/hooks","issue_events_url":"https://api.github.com/repos/apache/bookkeeper/issues/events{/number}","events_url":"https://api.github.com/repos/apache/bookkeeper/events","assignees_url":"https://api.github.com/repos/apache/bookkeeper/assignees{/user}","branches_url":"https://api.github.com/repos/apache/bookkeeper/branches{/branch}","tags_url":"https://api.github.com/repos/apache/bookkeeper/tags","blobs_url":"https://api.github.com/repos/apache/bookkeeper/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/bookkeeper/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/bookkeeper/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/bookkeeper/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/bookkeeper/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/bookkeeper/languages","stargazers_url":"https://api.github.com/repos/apache/bookkeeper/stargazers","contributors_url":"https://api.github.com/repos/apache/bookkeeper/contributors","subscribers_url":"https://api.github.com/repos/apache/bookkeeper/subscribers","subscription_url":"https://api.github.com/repos/apache/bookkeeper/subscription","commits_url":"https://api.github.com/repos/apache/bookkeeper/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/bookkeeper/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/bookkeeper/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/bookkeeper/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/{+path}","compare_url":"https://api.github.com/repos/apache/bookkeeper/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/bookkeeper/merges","archive_url":"https://api.github.com/repos/apache/bookkeeper/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/bookkeeper/downloads","issues_url":"https://api.github.com/repos/apache/bookkeeper/issues{/number}","pulls_url":"https://api.github.com/repos/apache/bookkeeper/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/bookkeeper/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/bookkeeper/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/bookkeeper/labels{/name}","releases_url":"https://api.github.com/repos/apache/bookkeeper/releases{/id}","deployments_url":"https://api.github.com/repos/apache/bookkeeper/deployments"},"score":21.144386},{"url":"https://api.github.com/repos/apache/bookkeeper/commits/46171e67e526702487641438144f28b7eb1aa07b","sha":"46171e67e526702487641438144f28b7eb1aa07b","html_url":"https://github.com/apache/bookkeeper/commit/46171e67e526702487641438144f28b7eb1aa07b","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/46171e67e526702487641438144f28b7eb1aa07b/comments","commit":{"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/46171e67e526702487641438144f28b7eb1aa07b","author":{"date":"2018-04-02T20:03:12.000-07:00","name":"Matteo Merli","email":"mmerli@apache.org"},"committer":{"date":"2018-04-02T20:03:12.000-07:00","name":"Matteo Merli","email":"mmerli@apache.org"},"message":"Refactored OrderedSafeExecutor and OrderedScheduler\n\nAs outlined in https://lists.apache.org/thread.html/102383ea42f473f36720637e41af0ee83fc38d9f992736e0d1a7f985%3Cdev.bookkeeper.apache.org%3E\n\nright now `OrderedSafeExecutor` is implemented on top of `OrderedScheduler`.  There are few problems with this approach that are causing impact on performance:\n\n 1. `OrderedScheduler` is a `ScheduledExecutorService` which uses a priority queue for tasks. The priority queue has a single mutex for both publishers/consumers on the queue\n 2. There are many objects created for each task submission, due to listenable future decorators\n\nSince in all cases in critical write/read path we don't need delay task execution or futures, we should try to have a light weight execution for that.\n\n### Modifications\n\n * Inverted the hierarchy between `OrderedSafeExecutor` and `OrderedScheduler`. Now the base class is `OrderedSafeExecutor` and the other extends from it, since it provides additional methods.\n * Moved `OrderedSafeExecutor` in `bookkeeper-common` since `OrderedScheduler` was already there.\n * Moved `OrderedSafeGenericCallback` in its own file, since it needs to be in `bookkeeper-server` module at this point.\n * Changed some method names from `submitOrdered()` into `executeOrdered()` to be consistent with JDK name (`submit()` returns a future while `execute()` returns void).\n * Changed `BookKeeper` instance of `scheduler` into `OrderedScheduler` so that the few cases which were using the `mainWorkerPool` could be easily converted to use the scheduler instead.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Andrey Yegorov <None>, Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1309 from merlimat/refactor-ordered-executor and squashes the following commits:\n\n9af6eadc2 [Matteo Merli] Fixed findbugs configuration to ignore genereted JMH code\nc85ad21e5 [Matteo Merli] Use ImmutableMap\n22eba18c8 [Matteo Merli] Added microbenchmark\n2c67d0e56 [Matteo Merli] Fix for TestMaxSizeWorkersQueue\n54a72ba1b [Matteo Merli] Fix for TestReadAheadEntryReader\n019d5202d [Matteo Merli] More fixes for submitOrdered\nb8175f311 [Matteo Merli] Fixed array initialization type\n5d68d431d [Matteo Merli] Fixed class names in integration tests\n7c529dde7 [Matteo Merli] Fixed submitOrdered in DL code\nc91259b7d [Matteo Merli] Removed \"final\" modifier on checkQueue\nc5f70d5b4 [Matteo Merli] Merge remote-tracking branch 'apache/master' into refactor-ordered-executor\n957c98309 [Matteo Merli] Correctly handle number of tasks in queue check\ne45f78c09 [Matteo Merli] Renamed into OrderedExecutor and OrderedGenericCallback\n926868429 [Matteo Merli] Refactored OrderedSafeExecutor and OrderedScheduler","tree":{"url":"https://api.github.com/repos/apache/bookkeeper/git/trees/80fe951da7167c3d531b8b3c49be9745be7cccbf","sha":"80fe951da7167c3d531b8b3c49be9745be7cccbf"},"comment_count":0},"author":{"login":"merlimat","id":62500,"avatar_url":"https://avatars2.githubusercontent.com/u/62500?v=4","gravatar_id":"","url":"https://api.github.com/users/merlimat","html_url":"https://github.com/merlimat","followers_url":"https://api.github.com/users/merlimat/followers","following_url":"https://api.github.com/users/merlimat/following{/other_user}","gists_url":"https://api.github.com/users/merlimat/gists{/gist_id}","starred_url":"https://api.github.com/users/merlimat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/merlimat/subscriptions","organizations_url":"https://api.github.com/users/merlimat/orgs","repos_url":"https://api.github.com/users/merlimat/repos","events_url":"https://api.github.com/users/merlimat/events{/privacy}","received_events_url":"https://api.github.com/users/merlimat/received_events","type":"User","site_admin":false},"committer":{"login":"merlimat","id":62500,"avatar_url":"https://avatars2.githubusercontent.com/u/62500?v=4","gravatar_id":"","url":"https://api.github.com/users/merlimat","html_url":"https://github.com/merlimat","followers_url":"https://api.github.com/users/merlimat/followers","following_url":"https://api.github.com/users/merlimat/following{/other_user}","gists_url":"https://api.github.com/users/merlimat/gists{/gist_id}","starred_url":"https://api.github.com/users/merlimat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/merlimat/subscriptions","organizations_url":"https://api.github.com/users/merlimat/orgs","repos_url":"https://api.github.com/users/merlimat/repos","events_url":"https://api.github.com/users/merlimat/events{/privacy}","received_events_url":"https://api.github.com/users/merlimat/received_events","type":"User","site_admin":false},"parents":[{"url":"https://api.github.com/repos/apache/bookkeeper/commits/678b88ca8e7fc313494b34167785b37102e809d0","html_url":"https://github.com/apache/bookkeeper/commit/678b88ca8e7fc313494b34167785b37102e809d0","sha":"678b88ca8e7fc313494b34167785b37102e809d0"}],"repository":{"id":1575956,"name":"bookkeeper","full_name":"apache/bookkeeper","owner":{"login":"apache","id":47359,"avatar_url":"https://avatars0.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/apache/bookkeeper","description":"Apache Bookkeeper","fork":false,"url":"https://api.github.com/repos/apache/bookkeeper","forks_url":"https://api.github.com/repos/apache/bookkeeper/forks","keys_url":"https://api.github.com/repos/apache/bookkeeper/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/bookkeeper/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/bookkeeper/teams","hooks_url":"https://api.github.com/repos/apache/bookkeeper/hooks","issue_events_url":"https://api.github.com/repos/apache/bookkeeper/issues/events{/number}","events_url":"https://api.github.com/repos/apache/bookkeeper/events","assignees_url":"https://api.github.com/repos/apache/bookkeeper/assignees{/user}","branches_url":"https://api.github.com/repos/apache/bookkeeper/branches{/branch}","tags_url":"https://api.github.com/repos/apache/bookkeeper/tags","blobs_url":"https://api.github.com/repos/apache/bookkeeper/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/bookkeeper/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/bookkeeper/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/bookkeeper/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/bookkeeper/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/bookkeeper/languages","stargazers_url":"https://api.github.com/repos/apache/bookkeeper/stargazers","contributors_url":"https://api.github.com/repos/apache/bookkeeper/contributors","subscribers_url":"https://api.github.com/repos/apache/bookkeeper/subscribers","subscription_url":"https://api.github.com/repos/apache/bookkeeper/subscription","commits_url":"https://api.github.com/repos/apache/bookkeeper/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/bookkeeper/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/bookkeeper/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/bookkeeper/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/{+path}","compare_url":"https://api.github.com/repos/apache/bookkeeper/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/bookkeeper/merges","archive_url":"https://api.github.com/repos/apache/bookkeeper/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/bookkeeper/downloads","issues_url":"https://api.github.com/repos/apache/bookkeeper/issues{/number}","pulls_url":"https://api.github.com/repos/apache/bookkeeper/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/bookkeeper/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/bookkeeper/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/bookkeeper/labels{/name}","releases_url":"https://api.github.com/repos/apache/bookkeeper/releases{/id}","deployments_url":"https://api.github.com/repos/apache/bookkeeper/deployments"},"score":19.422678},{"url":"https://api.github.com/repos/apache/bookkeeper/commits/9df8dac295c875ee3395d78a2bab3cda0c3c9ddd","sha":"9df8dac295c875ee3395d78a2bab3cda0c3c9ddd","html_url":"https://github.com/apache/bookkeeper/commit/9df8dac295c875ee3395d78a2bab3cda0c3c9ddd","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/9df8dac295c875ee3395d78a2bab3cda0c3c9ddd/comments","commit":{"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/9df8dac295c875ee3395d78a2bab3cda0c3c9ddd","author":{"date":"2018-03-29T16:04:37.000-07:00","name":"Matteo Merli","email":"mmerli@apache.org"},"committer":{"date":"2018-03-29T16:04:37.000-07:00","name":"Matteo Merli","email":"mmerli@apache.org"},"message":"Avoid acquiring closeLock.readLock() on every add/read operation\n\nIn the `BookieClient`, we are always acquiring a readlock when grabbing a connection to use for sending a write/read request.\n\nThe lock is the `closeLock` and it's only acquired in \"write\" mode when the `BookKeeper` instance is closed.\n\nThe problem with the read-lock is that it introduces contention between the threads that are acquiring it (even if all of them in read mode). Multiple threads can be be in read mode in the critical section, though they have contention when they're entering/exiting the section.\n\nAdditionally, the Java implementation of read/write lock is creating and destroying a lot of objects when that contention happens.\n\nMy understanding of the code is that we don't need to acquire the read lock in that point. The reason is that, we are already acquiring the lock in the `lookupClient()` method, although only if the pool is null. Additionally, when `Bookkeeper.close()` is invoked all PCBC will be set to closed as well, so it will not be possibile to create a new connection.\n\nAll the line changes in the patch are just removing the readLock acquire and try/finally, and reducing the indentation level.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1292 from merlimat/bookie-client-rw-lock and squashes the following commits:\n\n2104a3aa7 [Matteo Merli] Converted anonymous classes into lambdas\ncabad14e5 [Matteo Merli] Avoid acquiring closeLock.readLock() on every add/read operation","tree":{"url":"https://api.github.com/repos/apache/bookkeeper/git/trees/a40ef6bac4d902ea0d08b1976477bb57a125f371","sha":"a40ef6bac4d902ea0d08b1976477bb57a125f371"},"comment_count":0},"author":{"login":"merlimat","id":62500,"avatar_url":"https://avatars2.githubusercontent.com/u/62500?v=4","gravatar_id":"","url":"https://api.github.com/users/merlimat","html_url":"https://github.com/merlimat","followers_url":"https://api.github.com/users/merlimat/followers","following_url":"https://api.github.com/users/merlimat/following{/other_user}","gists_url":"https://api.github.com/users/merlimat/gists{/gist_id}","starred_url":"https://api.github.com/users/merlimat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/merlimat/subscriptions","organizations_url":"https://api.github.com/users/merlimat/orgs","repos_url":"https://api.github.com/users/merlimat/repos","events_url":"https://api.github.com/users/merlimat/events{/privacy}","received_events_url":"https://api.github.com/users/merlimat/received_events","type":"User","site_admin":false},"committer":{"login":"merlimat","id":62500,"avatar_url":"https://avatars2.githubusercontent.com/u/62500?v=4","gravatar_id":"","url":"https://api.github.com/users/merlimat","html_url":"https://github.com/merlimat","followers_url":"https://api.github.com/users/merlimat/followers","following_url":"https://api.github.com/users/merlimat/following{/other_user}","gists_url":"https://api.github.com/users/merlimat/gists{/gist_id}","starred_url":"https://api.github.com/users/merlimat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/merlimat/subscriptions","organizations_url":"https://api.github.com/users/merlimat/orgs","repos_url":"https://api.github.com/users/merlimat/repos","events_url":"https://api.github.com/users/merlimat/events{/privacy}","received_events_url":"https://api.github.com/users/merlimat/received_events","type":"User","site_admin":false},"parents":[{"url":"https://api.github.com/repos/apache/bookkeeper/commits/d8c95885136b46013ae942b3d32ae0ea66866dd2","html_url":"https://github.com/apache/bookkeeper/commit/d8c95885136b46013ae942b3d32ae0ea66866dd2","sha":"d8c95885136b46013ae942b3d32ae0ea66866dd2"}],"repository":{"id":1575956,"name":"bookkeeper","full_name":"apache/bookkeeper","owner":{"login":"apache","id":47359,"avatar_url":"https://avatars0.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/apache/bookkeeper","description":"Apache Bookkeeper","fork":false,"url":"https://api.github.com/repos/apache/bookkeeper","forks_url":"https://api.github.com/repos/apache/bookkeeper/forks","keys_url":"https://api.github.com/repos/apache/bookkeeper/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/bookkeeper/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/bookkeeper/teams","hooks_url":"https://api.github.com/repos/apache/bookkeeper/hooks","issue_events_url":"https://api.github.com/repos/apache/bookkeeper/issues/events{/number}","events_url":"https://api.github.com/repos/apache/bookkeeper/events","assignees_url":"https://api.github.com/repos/apache/bookkeeper/assignees{/user}","branches_url":"https://api.github.com/repos/apache/bookkeeper/branches{/branch}","tags_url":"https://api.github.com/repos/apache/bookkeeper/tags","blobs_url":"https://api.github.com/repos/apache/bookkeeper/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/bookkeeper/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/bookkeeper/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/bookkeeper/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/bookkeeper/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/bookkeeper/languages","stargazers_url":"https://api.github.com/repos/apache/bookkeeper/stargazers","contributors_url":"https://api.github.com/repos/apache/bookkeeper/contributors","subscribers_url":"https://api.github.com/repos/apache/bookkeeper/subscribers","subscription_url":"https://api.github.com/repos/apache/bookkeeper/subscription","commits_url":"https://api.github.com/repos/apache/bookkeeper/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/bookkeeper/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/bookkeeper/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/bookkeeper/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/{+path}","compare_url":"https://api.github.com/repos/apache/bookkeeper/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/bookkeeper/merges","archive_url":"https://api.github.com/repos/apache/bookkeeper/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/bookkeeper/downloads","issues_url":"https://api.github.com/repos/apache/bookkeeper/issues{/number}","pulls_url":"https://api.github.com/repos/apache/bookkeeper/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/bookkeeper/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/bookkeeper/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/bookkeeper/labels{/name}","releases_url":"https://api.github.com/repos/apache/bookkeeper/releases{/id}","deployments_url":"https://api.github.com/repos/apache/bookkeeper/deployments"},"score":19.064793},{"url":"https://api.github.com/repos/apache/bookkeeper/commits/d8c95885136b46013ae942b3d32ae0ea66866dd2","sha":"d8c95885136b46013ae942b3d32ae0ea66866dd2","html_url":"https://github.com/apache/bookkeeper/commit/d8c95885136b46013ae942b3d32ae0ea66866dd2","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/d8c95885136b46013ae942b3d32ae0ea66866dd2/comments","commit":{"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/d8c95885136b46013ae942b3d32ae0ea66866dd2","author":{"date":"2018-03-29T21:17:15.000+08:00","name":"Matteo Merli","email":"mmerli@apache.org"},"committer":{"date":"2018-03-29T21:17:15.000+08:00","name":"Jia Zhai","email":"zhaijia@apache.org"},"message":"Use reflection based CRC32 to pass direct memory pointer\n\nThe crc update with the bytebuffer is very expensive, especially in netty > 4.1.12.\n\n```java\ncrc.get().update(data.nioBuffer());\n```\n\nConverting a direct`ByteBuf` into a `ByteBuffer` with `data.nioBuffer()` is actually resorting to allocating an unpooled `DirectByteBuffer` which is actually killing the GC (since direct memory is freed when the `DirectByteBuffer` instances are GCed, but the pauses are > 1 second).\n\nThis is an adaptation of a change from Yahoo branch at https://github.com/yahoo/bookkeeper/commit/6c01ca2921a998f3bf2e85cacb27867773e7ea28\n\nInitially I though this change was not needed anymore in 4.7 codebase, and that is true for the CRC32c variant. For the regular CRC32, though, we need to avoid the bad behavior of unpooled direct buffers.\n\nAdditionally, as in #1306, the thread local variable was made static to avoid the leakage of instances per each ledger.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1307 from merlimat/crc32-bytebuffer and squashes the following commits:\n\n8b81245a0 [Matteo Merli] Made classed package private\na7ff1573f [Matteo Merli] Use reflection based CRC32 to pass direct memory pointer","tree":{"url":"https://api.github.com/repos/apache/bookkeeper/git/trees/073806881c6d428f1f430991d6503cabb55c35e9","sha":"073806881c6d428f1f430991d6503cabb55c35e9"},"comment_count":0},"author":{"login":"merlimat","id":62500,"avatar_url":"https://avatars2.githubusercontent.com/u/62500?v=4","gravatar_id":"","url":"https://api.github.com/users/merlimat","html_url":"https://github.com/merlimat","followers_url":"https://api.github.com/users/merlimat/followers","following_url":"https://api.github.com/users/merlimat/following{/other_user}","gists_url":"https://api.github.com/users/merlimat/gists{/gist_id}","starred_url":"https://api.github.com/users/merlimat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/merlimat/subscriptions","organizations_url":"https://api.github.com/users/merlimat/orgs","repos_url":"https://api.github.com/users/merlimat/repos","events_url":"https://api.github.com/users/merlimat/events{/privacy}","received_events_url":"https://api.github.com/users/merlimat/received_events","type":"User","site_admin":false},"committer":null,"parents":[{"url":"https://api.github.com/repos/apache/bookkeeper/commits/2bd24b7bbd531261bb5ca203b02575b1b1eb4890","html_url":"https://github.com/apache/bookkeeper/commit/2bd24b7bbd531261bb5ca203b02575b1b1eb4890","sha":"2bd24b7bbd531261bb5ca203b02575b1b1eb4890"}],"repository":{"id":1575956,"name":"bookkeeper","full_name":"apache/bookkeeper","owner":{"login":"apache","id":47359,"avatar_url":"https://avatars0.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/apache/bookkeeper","description":"Apache Bookkeeper","fork":false,"url":"https://api.github.com/repos/apache/bookkeeper","forks_url":"https://api.github.com/repos/apache/bookkeeper/forks","keys_url":"https://api.github.com/repos/apache/bookkeeper/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/bookkeeper/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/bookkeeper/teams","hooks_url":"https://api.github.com/repos/apache/bookkeeper/hooks","issue_events_url":"https://api.github.com/repos/apache/bookkeeper/issues/events{/number}","events_url":"https://api.github.com/repos/apache/bookkeeper/events","assignees_url":"https://api.github.com/repos/apache/bookkeeper/assignees{/user}","branches_url":"https://api.github.com/repos/apache/bookkeeper/branches{/branch}","tags_url":"https://api.github.com/repos/apache/bookkeeper/tags","blobs_url":"https://api.github.com/repos/apache/bookkeeper/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/bookkeeper/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/bookkeeper/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/bookkeeper/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/bookkeeper/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/bookkeeper/languages","stargazers_url":"https://api.github.com/repos/apache/bookkeeper/stargazers","contributors_url":"https://api.github.com/repos/apache/bookkeeper/contributors","subscribers_url":"https://api.github.com/repos/apache/bookkeeper/subscribers","subscription_url":"https://api.github.com/repos/apache/bookkeeper/subscription","commits_url":"https://api.github.com/repos/apache/bookkeeper/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/bookkeeper/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/bookkeeper/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/bookkeeper/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/{+path}","compare_url":"https://api.github.com/repos/apache/bookkeeper/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/bookkeeper/merges","archive_url":"https://api.github.com/repos/apache/bookkeeper/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/bookkeeper/downloads","issues_url":"https://api.github.com/repos/apache/bookkeeper/issues{/number}","pulls_url":"https://api.github.com/repos/apache/bookkeeper/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/bookkeeper/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/bookkeeper/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/bookkeeper/labels{/name}","releases_url":"https://api.github.com/repos/apache/bookkeeper/releases{/id}","deployments_url":"https://api.github.com/repos/apache/bookkeeper/deployments"},"score":18.856842},{"url":"https://api.github.com/repos/apache/bookkeeper/commits/2bd24b7bbd531261bb5ca203b02575b1b1eb4890","sha":"2bd24b7bbd531261bb5ca203b02575b1b1eb4890","html_url":"https://github.com/apache/bookkeeper/commit/2bd24b7bbd531261bb5ca203b02575b1b1eb4890","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/2bd24b7bbd531261bb5ca203b02575b1b1eb4890/comments","commit":{"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/2bd24b7bbd531261bb5ca203b02575b1b1eb4890","author":{"date":"2018-03-28T22:19:37.000-07:00","name":"cguttapalem","email":"cguttapalem@salesforce.com"},"committer":{"date":"2018-03-28T22:19:37.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"message":"Issue #1282: call to appendLedgersMap in flushCompactionLog\n\nDescriptions of the changes in this PR:\n\nwith this change https://github.com/apache/bookkeeper/commit/3392beee5c70abe36d36604723e14d97b7764be9 compactionlog was introduced. But for compactionlog call to appendLedgersMap (// Append ledgers map at the end of entry log) isn't made.\n\nSo for these logs, getEntryLogMetadata call has to call extractEntryLogMetadataByScanning for getting the metadata of entrylog. Which is a perf hit.\n\nMaster Issue: #1282\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Yiming Zang <yzang2016@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1283 from reddycharan/compactionlogfix, closes #1282","tree":{"url":"https://api.github.com/repos/apache/bookkeeper/git/trees/1a0524cf732752dedea6d5ee85199d5224e89d9e","sha":"1a0524cf732752dedea6d5ee85199d5224e89d9e"},"comment_count":0},"author":null,"committer":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"parents":[{"url":"https://api.github.com/repos/apache/bookkeeper/commits/db713f32c24cc9345d8b813aeef9d079b254d16a","html_url":"https://github.com/apache/bookkeeper/commit/db713f32c24cc9345d8b813aeef9d079b254d16a","sha":"db713f32c24cc9345d8b813aeef9d079b254d16a"}],"repository":{"id":1575956,"name":"bookkeeper","full_name":"apache/bookkeeper","owner":{"login":"apache","id":47359,"avatar_url":"https://avatars0.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/apache/bookkeeper","description":"Apache Bookkeeper","fork":false,"url":"https://api.github.com/repos/apache/bookkeeper","forks_url":"https://api.github.com/repos/apache/bookkeeper/forks","keys_url":"https://api.github.com/repos/apache/bookkeeper/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/bookkeeper/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/bookkeeper/teams","hooks_url":"https://api.github.com/repos/apache/bookkeeper/hooks","issue_events_url":"https://api.github.com/repos/apache/bookkeeper/issues/events{/number}","events_url":"https://api.github.com/repos/apache/bookkeeper/events","assignees_url":"https://api.github.com/repos/apache/bookkeeper/assignees{/user}","branches_url":"https://api.github.com/repos/apache/bookkeeper/branches{/branch}","tags_url":"https://api.github.com/repos/apache/bookkeeper/tags","blobs_url":"https://api.github.com/repos/apache/bookkeeper/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/bookkeeper/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/bookkeeper/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/bookkeeper/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/bookkeeper/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/bookkeeper/languages","stargazers_url":"https://api.github.com/repos/apache/bookkeeper/stargazers","contributors_url":"https://api.github.com/repos/apache/bookkeeper/contributors","subscribers_url":"https://api.github.com/repos/apache/bookkeeper/subscribers","subscription_url":"https://api.github.com/repos/apache/bookkeeper/subscription","commits_url":"https://api.github.com/repos/apache/bookkeeper/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/bookkeeper/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/bookkeeper/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/bookkeeper/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/{+path}","compare_url":"https://api.github.com/repos/apache/bookkeeper/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/bookkeeper/merges","archive_url":"https://api.github.com/repos/apache/bookkeeper/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/bookkeeper/downloads","issues_url":"https://api.github.com/repos/apache/bookkeeper/issues{/number}","pulls_url":"https://api.github.com/repos/apache/bookkeeper/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/bookkeeper/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/bookkeeper/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/bookkeeper/labels{/name}","releases_url":"https://api.github.com/repos/apache/bookkeeper/releases{/id}","deployments_url":"https://api.github.com/repos/apache/bookkeeper/deployments"},"score":19.253952},{"url":"https://api.github.com/repos/apache/bookkeeper/commits/c1947c7b7d7c0a6736b2a35511b5f70072c12972","sha":"c1947c7b7d7c0a6736b2a35511b5f70072c12972","html_url":"https://github.com/apache/bookkeeper/commit/c1947c7b7d7c0a6736b2a35511b5f70072c12972","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/c1947c7b7d7c0a6736b2a35511b5f70072c12972/comments","commit":{"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/c1947c7b7d7c0a6736b2a35511b5f70072c12972","author":{"date":"2018-03-27T23:25:00.000-07:00","name":"Ivan Kelly","email":"ivank@apache.org"},"committer":{"date":"2018-03-27T23:25:00.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"message":"Add sync variants of all methods in handles\n\nAs discussed on the mailing list [1], this patch removes the\ninconsistency around the naming of the close call on the new handle\nAPIs, by creating sync versions of each async calls, and renaming the\nasync versions to have the suffix \"Async\".\n\nMost of the changes are very mechanical - just a copy of the old\nmethod and some small fixups the javadoc. One thing to note is that\nI've made a copy of the close and closeAsync methods in the\nWriteHandle interface, so that the ReadHandle and Handle javadoc for\nthese methods do not have to talk about what it means to close/seal a\nledger.\n\nAnother change is that I've removed the SneakyThrows from close, that\nwould have also been needed on the other sync methods. Instead, I pass a\nexception handler to FutureUtils which generates a BKException.\n\n[1] https://lists.apache.org/thread.html/c3784cffb949438510d21e5eac8c0351865c6748c42c380e673a60db%3Cdev.bookkeeper.apache.org%3E\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1288 from ivankelly/async-rename","tree":{"url":"https://api.github.com/repos/apache/bookkeeper/git/trees/401ee864fc16409944371823b539d7cc98a1a1f0","sha":"401ee864fc16409944371823b539d7cc98a1a1f0"},"comment_count":0},"author":{"login":"ivankelly","id":54955,"avatar_url":"https://avatars3.githubusercontent.com/u/54955?v=4","gravatar_id":"","url":"https://api.github.com/users/ivankelly","html_url":"https://github.com/ivankelly","followers_url":"https://api.github.com/users/ivankelly/followers","following_url":"https://api.github.com/users/ivankelly/following{/other_user}","gists_url":"https://api.github.com/users/ivankelly/gists{/gist_id}","starred_url":"https://api.github.com/users/ivankelly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivankelly/subscriptions","organizations_url":"https://api.github.com/users/ivankelly/orgs","repos_url":"https://api.github.com/users/ivankelly/repos","events_url":"https://api.github.com/users/ivankelly/events{/privacy}","received_events_url":"https://api.github.com/users/ivankelly/received_events","type":"User","site_admin":false},"committer":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"parents":[{"url":"https://api.github.com/repos/apache/bookkeeper/commits/52cefcfae654e317f341a58da0d0a07e902eefa3","html_url":"https://github.com/apache/bookkeeper/commit/52cefcfae654e317f341a58da0d0a07e902eefa3","sha":"52cefcfae654e317f341a58da0d0a07e902eefa3"}],"repository":{"id":1575956,"name":"bookkeeper","full_name":"apache/bookkeeper","owner":{"login":"apache","id":47359,"avatar_url":"https://avatars0.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/apache/bookkeeper","description":"Apache Bookkeeper","fork":false,"url":"https://api.github.com/repos/apache/bookkeeper","forks_url":"https://api.github.com/repos/apache/bookkeeper/forks","keys_url":"https://api.github.com/repos/apache/bookkeeper/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/bookkeeper/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/bookkeeper/teams","hooks_url":"https://api.github.com/repos/apache/bookkeeper/hooks","issue_events_url":"https://api.github.com/repos/apache/bookkeeper/issues/events{/number}","events_url":"https://api.github.com/repos/apache/bookkeeper/events","assignees_url":"https://api.github.com/repos/apache/bookkeeper/assignees{/user}","branches_url":"https://api.github.com/repos/apache/bookkeeper/branches{/branch}","tags_url":"https://api.github.com/repos/apache/bookkeeper/tags","blobs_url":"https://api.github.com/repos/apache/bookkeeper/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/bookkeeper/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/bookkeeper/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/bookkeeper/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/bookkeeper/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/bookkeeper/languages","stargazers_url":"https://api.github.com/repos/apache/bookkeeper/stargazers","contributors_url":"https://api.github.com/repos/apache/bookkeeper/contributors","subscribers_url":"https://api.github.com/repos/apache/bookkeeper/subscribers","subscription_url":"https://api.github.com/repos/apache/bookkeeper/subscription","commits_url":"https://api.github.com/repos/apache/bookkeeper/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/bookkeeper/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/bookkeeper/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/bookkeeper/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/{+path}","compare_url":"https://api.github.com/repos/apache/bookkeeper/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/bookkeeper/merges","archive_url":"https://api.github.com/repos/apache/bookkeeper/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/bookkeeper/downloads","issues_url":"https://api.github.com/repos/apache/bookkeeper/issues{/number}","pulls_url":"https://api.github.com/repos/apache/bookkeeper/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/bookkeeper/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/bookkeeper/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/bookkeeper/labels{/name}","releases_url":"https://api.github.com/repos/apache/bookkeeper/releases{/id}","deployments_url":"https://api.github.com/repos/apache/bookkeeper/deployments"},"score":18.81283},{"url":"https://api.github.com/repos/apache/bookkeeper/commits/c4a4318fcd308351b66c39599187c2e79fb0687a","sha":"c4a4318fcd308351b66c39599187c2e79fb0687a","html_url":"https://github.com/apache/bookkeeper/commit/c4a4318fcd308351b66c39599187c2e79fb0687a","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/c4a4318fcd308351b66c39599187c2e79fb0687a/comments","commit":{"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/c4a4318fcd308351b66c39599187c2e79fb0687a","author":{"date":"2018-03-20T22:54:40.000+08:00","name":"Sijie Guo","email":"sijie@apache.org"},"committer":{"date":"2018-03-20T22:54:40.000+08:00","name":"Jia Zhai","email":"zhaijia@apache.org"},"message":"Implement `toString` method for CheckpointList and BufferedLogChannel\n\nDescriptions of the changes in this PR:\n\n```\nFlushing entry logger 102 back to filesystem, pending for syncing entry loggers : [org.apache.bookkeeper.bookie.EntryLogger$BufferedLogChannel7d98c184].\n\norg.apache.bookkeeper.bookie.SortedLedgerStorage - Reached size org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointListd2c00ea5\n```\n\n`CheckpointList` and `BufferedLogChannel` is missing `toString` implementation.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1278 from sijie/fix_tostring_issue","tree":{"url":"https://api.github.com/repos/apache/bookkeeper/git/trees/547a79d0a565eb66b6be904254e1458b91607ccb","sha":"547a79d0a565eb66b6be904254e1458b91607ccb"},"comment_count":0},"author":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"committer":null,"parents":[{"url":"https://api.github.com/repos/apache/bookkeeper/commits/61ed8a697e9c1f6edbd8996819f602f6ca79920d","html_url":"https://github.com/apache/bookkeeper/commit/61ed8a697e9c1f6edbd8996819f602f6ca79920d","sha":"61ed8a697e9c1f6edbd8996819f602f6ca79920d"}],"repository":{"id":1575956,"name":"bookkeeper","full_name":"apache/bookkeeper","owner":{"login":"apache","id":47359,"avatar_url":"https://avatars0.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/apache/bookkeeper","description":"Apache Bookkeeper","fork":false,"url":"https://api.github.com/repos/apache/bookkeeper","forks_url":"https://api.github.com/repos/apache/bookkeeper/forks","keys_url":"https://api.github.com/repos/apache/bookkeeper/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/bookkeeper/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/bookkeeper/teams","hooks_url":"https://api.github.com/repos/apache/bookkeeper/hooks","issue_events_url":"https://api.github.com/repos/apache/bookkeeper/issues/events{/number}","events_url":"https://api.github.com/repos/apache/bookkeeper/events","assignees_url":"https://api.github.com/repos/apache/bookkeeper/assignees{/user}","branches_url":"https://api.github.com/repos/apache/bookkeeper/branches{/branch}","tags_url":"https://api.github.com/repos/apache/bookkeeper/tags","blobs_url":"https://api.github.com/repos/apache/bookkeeper/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/bookkeeper/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/bookkeeper/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/bookkeeper/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/bookkeeper/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/bookkeeper/languages","stargazers_url":"https://api.github.com/repos/apache/bookkeeper/stargazers","contributors_url":"https://api.github.com/repos/apache/bookkeeper/contributors","subscribers_url":"https://api.github.com/repos/apache/bookkeeper/subscribers","subscription_url":"https://api.github.com/repos/apache/bookkeeper/subscription","commits_url":"https://api.github.com/repos/apache/bookkeeper/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/bookkeeper/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/bookkeeper/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/bookkeeper/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/{+path}","compare_url":"https://api.github.com/repos/apache/bookkeeper/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/bookkeeper/merges","archive_url":"https://api.github.com/repos/apache/bookkeeper/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/bookkeeper/downloads","issues_url":"https://api.github.com/repos/apache/bookkeeper/issues{/number}","pulls_url":"https://api.github.com/repos/apache/bookkeeper/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/bookkeeper/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/bookkeeper/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/bookkeeper/labels{/name}","releases_url":"https://api.github.com/repos/apache/bookkeeper/releases{/id}","deployments_url":"https://api.github.com/repos/apache/bookkeeper/deployments"},"score":20.212692},{"url":"https://api.github.com/repos/apache/bookkeeper/commits/b92251379b1183fea3fe124637390ddc72d5a069","sha":"b92251379b1183fea3fe124637390ddc72d5a069","html_url":"https://github.com/apache/bookkeeper/commit/b92251379b1183fea3fe124637390ddc72d5a069","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/b92251379b1183fea3fe124637390ddc72d5a069/comments","commit":{"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/b92251379b1183fea3fe124637390ddc72d5a069","author":{"date":"2018-03-16T21:31:24.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"committer":{"date":"2018-03-16T21:31:24.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"message":"Improve `BookKeeperAdmin#format` to avoid constructing redundant resources\n\nDescriptions of the changes in this PR:\n\n*Problem*\n\nAfter metadata service uri change, all the metadata managers can be retrieved via metadata drivers.\nSo there is no need to construct another bookkeeper client to get ledger manager factory for formatting ledger metadata.\n\n*Solution*\n\n- remove constructing bookkeeper client and use the metadata driver to get ledger manager factory to format ledger metadata\n- expose layout manager in bookie driver as well\n- since we are adding `getLayoutManager` in bookie driver, we need to update `MetadataDriversTest`. cleanup the test drivers in `MetadataDriversTest`.\n\nRelated Issue: #1269\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1270 from sijie/improve_format","tree":{"url":"https://api.github.com/repos/apache/bookkeeper/git/trees/0eae4ebd65936bcca019b41e72ba59c048568e42","sha":"0eae4ebd65936bcca019b41e72ba59c048568e42"},"comment_count":0},"author":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"committer":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"parents":[{"url":"https://api.github.com/repos/apache/bookkeeper/commits/20fc51cfddc5e271385795d7b180cf5d35b75a3e","html_url":"https://github.com/apache/bookkeeper/commit/20fc51cfddc5e271385795d7b180cf5d35b75a3e","sha":"20fc51cfddc5e271385795d7b180cf5d35b75a3e"}],"repository":{"id":1575956,"name":"bookkeeper","full_name":"apache/bookkeeper","owner":{"login":"apache","id":47359,"avatar_url":"https://avatars0.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/apache/bookkeeper","description":"Apache Bookkeeper","fork":false,"url":"https://api.github.com/repos/apache/bookkeeper","forks_url":"https://api.github.com/repos/apache/bookkeeper/forks","keys_url":"https://api.github.com/repos/apache/bookkeeper/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/bookkeeper/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/bookkeeper/teams","hooks_url":"https://api.github.com/repos/apache/bookkeeper/hooks","issue_events_url":"https://api.github.com/repos/apache/bookkeeper/issues/events{/number}","events_url":"https://api.github.com/repos/apache/bookkeeper/events","assignees_url":"https://api.github.com/repos/apache/bookkeeper/assignees{/user}","branches_url":"https://api.github.com/repos/apache/bookkeeper/branches{/branch}","tags_url":"https://api.github.com/repos/apache/bookkeeper/tags","blobs_url":"https://api.github.com/repos/apache/bookkeeper/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/bookkeeper/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/bookkeeper/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/bookkeeper/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/bookkeeper/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/bookkeeper/languages","stargazers_url":"https://api.github.com/repos/apache/bookkeeper/stargazers","contributors_url":"https://api.github.com/repos/apache/bookkeeper/contributors","subscribers_url":"https://api.github.com/repos/apache/bookkeeper/subscribers","subscription_url":"https://api.github.com/repos/apache/bookkeeper/subscription","commits_url":"https://api.github.com/repos/apache/bookkeeper/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/bookkeeper/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/bookkeeper/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/bookkeeper/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/{+path}","compare_url":"https://api.github.com/repos/apache/bookkeeper/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/bookkeeper/merges","archive_url":"https://api.github.com/repos/apache/bookkeeper/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/bookkeeper/downloads","issues_url":"https://api.github.com/repos/apache/bookkeeper/issues{/number}","pulls_url":"https://api.github.com/repos/apache/bookkeeper/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/bookkeeper/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/bookkeeper/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/bookkeeper/labels{/name}","releases_url":"https://api.github.com/repos/apache/bookkeeper/releases{/id}","deployments_url":"https://api.github.com/repos/apache/bookkeeper/deployments"},"score":19.065386},{"url":"https://api.github.com/repos/apache/bookkeeper/commits/9aececa466ed1bc2be731543bd549a51d7c8ed3c","sha":"9aececa466ed1bc2be731543bd549a51d7c8ed3c","html_url":"https://github.com/apache/bookkeeper/commit/9aececa466ed1bc2be731543bd549a51d7c8ed3c","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/9aececa466ed1bc2be731543bd549a51d7c8ed3c/comments","commit":{"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/9aececa466ed1bc2be731543bd549a51d7c8ed3c","author":{"date":"2018-03-16T11:19:49.000-07:00","name":"Ivan Kelly","email":"ivank@apache.org"},"committer":{"date":"2018-03-16T11:19:49.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"message":"Close bookkeeper client used in format\n\nOtherwise, the executors threads could keep the process calling it\nalive. This isn't a problem for BookieShell, since it does a System.exit,\nbut it currently is for pulsar metadata cluster format.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Matteo Merli <mmerli@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #1269 from ivankelly/close-format-client","tree":{"url":"https://api.github.com/repos/apache/bookkeeper/git/trees/996a930a4618673f347931814f8261a0f0ee4973","sha":"996a930a4618673f347931814f8261a0f0ee4973"},"comment_count":0},"author":{"login":"ivankelly","id":54955,"avatar_url":"https://avatars3.githubusercontent.com/u/54955?v=4","gravatar_id":"","url":"https://api.github.com/users/ivankelly","html_url":"https://github.com/ivankelly","followers_url":"https://api.github.com/users/ivankelly/followers","following_url":"https://api.github.com/users/ivankelly/following{/other_user}","gists_url":"https://api.github.com/users/ivankelly/gists{/gist_id}","starred_url":"https://api.github.com/users/ivankelly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivankelly/subscriptions","organizations_url":"https://api.github.com/users/ivankelly/orgs","repos_url":"https://api.github.com/users/ivankelly/repos","events_url":"https://api.github.com/users/ivankelly/events{/privacy}","received_events_url":"https://api.github.com/users/ivankelly/received_events","type":"User","site_admin":false},"committer":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"parents":[{"url":"https://api.github.com/repos/apache/bookkeeper/commits/adc906f60ff74cce33b150f53a3e2a203c0920d4","html_url":"https://github.com/apache/bookkeeper/commit/adc906f60ff74cce33b150f53a3e2a203c0920d4","sha":"adc906f60ff74cce33b150f53a3e2a203c0920d4"}],"repository":{"id":1575956,"name":"bookkeeper","full_name":"apache/bookkeeper","owner":{"login":"apache","id":47359,"avatar_url":"https://avatars0.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/apache/bookkeeper","description":"Apache Bookkeeper","fork":false,"url":"https://api.github.com/repos/apache/bookkeeper","forks_url":"https://api.github.com/repos/apache/bookkeeper/forks","keys_url":"https://api.github.com/repos/apache/bookkeeper/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/bookkeeper/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/bookkeeper/teams","hooks_url":"https://api.github.com/repos/apache/bookkeeper/hooks","issue_events_url":"https://api.github.com/repos/apache/bookkeeper/issues/events{/number}","events_url":"https://api.github.com/repos/apache/bookkeeper/events","assignees_url":"https://api.github.com/repos/apache/bookkeeper/assignees{/user}","branches_url":"https://api.github.com/repos/apache/bookkeeper/branches{/branch}","tags_url":"https://api.github.com/repos/apache/bookkeeper/tags","blobs_url":"https://api.github.com/repos/apache/bookkeeper/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/bookkeeper/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/bookkeeper/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/bookkeeper/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/bookkeeper/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/bookkeeper/languages","stargazers_url":"https://api.github.com/repos/apache/bookkeeper/stargazers","contributors_url":"https://api.github.com/repos/apache/bookkeeper/contributors","subscribers_url":"https://api.github.com/repos/apache/bookkeeper/subscribers","subscription_url":"https://api.github.com/repos/apache/bookkeeper/subscription","commits_url":"https://api.github.com/repos/apache/bookkeeper/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/bookkeeper/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/bookkeeper/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/bookkeeper/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/{+path}","compare_url":"https://api.github.com/repos/apache/bookkeeper/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/bookkeeper/merges","archive_url":"https://api.github.com/repos/apache/bookkeeper/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/bookkeeper/downloads","issues_url":"https://api.github.com/repos/apache/bookkeeper/issues{/number}","pulls_url":"https://api.github.com/repos/apache/bookkeeper/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/bookkeeper/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/bookkeeper/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/bookkeeper/labels{/name}","releases_url":"https://api.github.com/repos/apache/bookkeeper/releases{/id}","deployments_url":"https://api.github.com/repos/apache/bookkeeper/deployments"},"score":19.036665},{"url":"https://api.github.com/repos/apache/bookkeeper/commits/b53c0c3370c42d753afb852824ea12d2dbce4f2e","sha":"b53c0c3370c42d753afb852824ea12d2dbce4f2e","html_url":"https://github.com/apache/bookkeeper/commit/b53c0c3370c42d753afb852824ea12d2dbce4f2e","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/b53c0c3370c42d753afb852824ea12d2dbce4f2e/comments","commit":{"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/b53c0c3370c42d753afb852824ea12d2dbce4f2e","author":{"date":"2018-03-15T22:27:49.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"committer":{"date":"2018-03-15T22:27:49.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"message":"BP-29 (task 4): use metadata service uri for constructing registration manager and ledger manager factory\n\nDescriptions of the changes in this PR:\n\nThe main changes are at two places:\n\n- Deprecating using ServerConfiguration#getRegistrationManagerClass(). Changed Bookie.java to use MetadataBookieDriver to getRegistrationManager().\n- Use MetadataBookieDriver/MetadataClientDriver to retrieve ledger manager factory in Bookie.java / BookKeeper.java\n\nThe other changes are in-place changes for replacing using registration manager to using metadata drivers.\n\n- provides a few util functions in `MetadataDrivers` to run `functions` with registration manager / ledger manager factory\n\nMaster Issue: #1123\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1251 from sijie/use_metadata_service_uri_in_registration_manager","tree":{"url":"https://api.github.com/repos/apache/bookkeeper/git/trees/d6aa5f7f7b9945130e78d91cd49333c9acde1e7e","sha":"d6aa5f7f7b9945130e78d91cd49333c9acde1e7e"},"comment_count":0},"author":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"committer":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"parents":[{"url":"https://api.github.com/repos/apache/bookkeeper/commits/fa4e9d7d8cc91c984383779e8bad2248b7951540","html_url":"https://github.com/apache/bookkeeper/commit/fa4e9d7d8cc91c984383779e8bad2248b7951540","sha":"fa4e9d7d8cc91c984383779e8bad2248b7951540"}],"repository":{"id":1575956,"name":"bookkeeper","full_name":"apache/bookkeeper","owner":{"login":"apache","id":47359,"avatar_url":"https://avatars0.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/apache/bookkeeper","description":"Apache Bookkeeper","fork":false,"url":"https://api.github.com/repos/apache/bookkeeper","forks_url":"https://api.github.com/repos/apache/bookkeeper/forks","keys_url":"https://api.github.com/repos/apache/bookkeeper/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/bookkeeper/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/bookkeeper/teams","hooks_url":"https://api.github.com/repos/apache/bookkeeper/hooks","issue_events_url":"https://api.github.com/repos/apache/bookkeeper/issues/events{/number}","events_url":"https://api.github.com/repos/apache/bookkeeper/events","assignees_url":"https://api.github.com/repos/apache/bookkeeper/assignees{/user}","branches_url":"https://api.github.com/repos/apache/bookkeeper/branches{/branch}","tags_url":"https://api.github.com/repos/apache/bookkeeper/tags","blobs_url":"https://api.github.com/repos/apache/bookkeeper/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/bookkeeper/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/bookkeeper/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/bookkeeper/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/bookkeeper/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/bookkeeper/languages","stargazers_url":"https://api.github.com/repos/apache/bookkeeper/stargazers","contributors_url":"https://api.github.com/repos/apache/bookkeeper/contributors","subscribers_url":"https://api.github.com/repos/apache/bookkeeper/subscribers","subscription_url":"https://api.github.com/repos/apache/bookkeeper/subscription","commits_url":"https://api.github.com/repos/apache/bookkeeper/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/bookkeeper/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/bookkeeper/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/bookkeeper/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/{+path}","compare_url":"https://api.github.com/repos/apache/bookkeeper/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/bookkeeper/merges","archive_url":"https://api.github.com/repos/apache/bookkeeper/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/bookkeeper/downloads","issues_url":"https://api.github.com/repos/apache/bookkeeper/issues{/number}","pulls_url":"https://api.github.com/repos/apache/bookkeeper/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/bookkeeper/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/bookkeeper/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/bookkeeper/labels{/name}","releases_url":"https://api.github.com/repos/apache/bookkeeper/releases{/id}","deployments_url":"https://api.github.com/repos/apache/bookkeeper/deployments"},"score":18.814514},{"url":"https://api.github.com/repos/apache/bookkeeper/commits/3bff19956e70e37c025a8e29aa8428937af77aa1","sha":"3bff19956e70e37c025a8e29aa8428937af77aa1","html_url":"https://github.com/apache/bookkeeper/commit/3bff19956e70e37c025a8e29aa8428937af77aa1","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/3bff19956e70e37c025a8e29aa8428937af77aa1/comments","commit":{"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/3bff19956e70e37c025a8e29aa8428937af77aa1","author":{"date":"2018-03-14T23:48:32.000-07:00","name":"Matteo Merli","email":"mmerli@apache.org"},"committer":{"date":"2018-03-14T23:48:32.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"message":"Collect Prometheus latency stats using DataSketches\n\nThe implementation for collecting and estimating the latency quantiles in the Prometheus Java client library is very slow and it is impacting the the bookie performance.\n\nI have added a micro-benchmark that tests our various stats providers. These tests are simulating 16 concurrent threads updating the stats.\n\n#### Counter increment\n```\nBenchmark                              (statsProvider)   Mode  Cnt    Score      Error   Units\nStatsLoggerBenchmark.counterIncrement       Prometheus  thrpt    3  391.882   786.987  ops/us\nStatsLoggerBenchmark.counterIncrement         Codahale  thrpt    3  449.341  1337.736  ops/us\nStatsLoggerBenchmark.counterIncrement          Twitter  thrpt    3   43.354     9.331  ops/us\nStatsLoggerBenchmark.counterIncrement          Ostrich  thrpt    3   43.790     1.332  ops/us\n```\n\nHere prometheus is fast, though not as fast as a simple `LongAdder` which can reach ~500M ops/sec.\n\n#### Latency quantiles\n\n```\nBenchmark                              (statsProvider)   Mode  Cnt    Score      Error   Units\nStatsLoggerBenchmark.recordLatency          Prometheus  thrpt    3    0.255     0.667  ops/us\nStatsLoggerBenchmark.recordLatency            Codahale  thrpt    3    4.963     1.671  ops/us\nStatsLoggerBenchmark.recordLatency             Twitter  thrpt    3    4.793     0.766  ops/us\nStatsLoggerBenchmark.recordLatency             Ostrich  thrpt    3    2.473     6.394  ops/us\n```\n\nHere is where Prometheus is super-slow: 250K ops/second max, mostly due to contention and GC pressure.\n\n## Modification\n\nI have re-adapted a stats collector I had done in the Yahoo branch:\nhttps://github.com/yahoo/bookkeeper/tree/yahoo-4.3/bookkeeper-stats-providers/datasketches-metrics-provider/src/main/java/org/apache/bokkeeper/stats/datasketches\n\nThis is based on the [DataSketches](https://datasketches.github.io/) library to have very fast and lightweight quantile estimates (along with a number of other operations), plus some tricks to avoid concurrency issues by using thread local collectors and aggregating when needed in background.\n\nAfter the change, the throughput is 150x the original prometheus collector.\n\n```\nBenchmark                              (statsProvider)   Mode  Cnt    Score     Error   Units\nStatsLoggerBenchmark.counterIncrement       Prometheus  thrpt    3  531.906  129.602  ops/us\nStatsLoggerBenchmark.recordLatency          Prometheus  thrpt    3   27.538    5.893  ops/us\n```\n\nIt is worth noting that the main bottle-neck in the `recordLatency` test is now the `System.nanoTime()`\ncall used to pass different samples to the stat logger.\n\n`System.nanoTime()` is not super fast:\n\n```\nBenchmark                               (statsProvider)   Mode  Cnt    Score     Error   Units\nStatsLoggerBenchmark.currentTimeMillis              N/A  thrpt    3  161.502  267.238  ops/us\nStatsLoggerBenchmark.nanoTime                       N/A  thrpt    3   32.822    2.256  ops/us\n```\n\nBy removing the `System.nanoTime()` call from the benchmark, the Prometheus+DataSketches collector results in:\n\n```\nBenchmark                               (statsProvider)   Mode  Cnt    Score     Error   Units\nStatsLoggerBenchmark.recordLatency           Prometheus  thrpt    3  108.542   31.848  ops/us\n```\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1245 from merlimat/prometheus-datasketches","tree":{"url":"https://api.github.com/repos/apache/bookkeeper/git/trees/1ff1ff03d2b17ec6b521cf116a8b37989104b596","sha":"1ff1ff03d2b17ec6b521cf116a8b37989104b596"},"comment_count":0},"author":{"login":"merlimat","id":62500,"avatar_url":"https://avatars2.githubusercontent.com/u/62500?v=4","gravatar_id":"","url":"https://api.github.com/users/merlimat","html_url":"https://github.com/merlimat","followers_url":"https://api.github.com/users/merlimat/followers","following_url":"https://api.github.com/users/merlimat/following{/other_user}","gists_url":"https://api.github.com/users/merlimat/gists{/gist_id}","starred_url":"https://api.github.com/users/merlimat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/merlimat/subscriptions","organizations_url":"https://api.github.com/users/merlimat/orgs","repos_url":"https://api.github.com/users/merlimat/repos","events_url":"https://api.github.com/users/merlimat/events{/privacy}","received_events_url":"https://api.github.com/users/merlimat/received_events","type":"User","site_admin":false},"committer":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"parents":[{"url":"https://api.github.com/repos/apache/bookkeeper/commits/70b2e4cf49d2fc4903c277d309dbe8c0bc5e4d7d","html_url":"https://github.com/apache/bookkeeper/commit/70b2e4cf49d2fc4903c277d309dbe8c0bc5e4d7d","sha":"70b2e4cf49d2fc4903c277d309dbe8c0bc5e4d7d"}],"repository":{"id":1575956,"name":"bookkeeper","full_name":"apache/bookkeeper","owner":{"login":"apache","id":47359,"avatar_url":"https://avatars0.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/apache/bookkeeper","description":"Apache Bookkeeper","fork":false,"url":"https://api.github.com/repos/apache/bookkeeper","forks_url":"https://api.github.com/repos/apache/bookkeeper/forks","keys_url":"https://api.github.com/repos/apache/bookkeeper/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/bookkeeper/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/bookkeeper/teams","hooks_url":"https://api.github.com/repos/apache/bookkeeper/hooks","issue_events_url":"https://api.github.com/repos/apache/bookkeeper/issues/events{/number}","events_url":"https://api.github.com/repos/apache/bookkeeper/events","assignees_url":"https://api.github.com/repos/apache/bookkeeper/assignees{/user}","branches_url":"https://api.github.com/repos/apache/bookkeeper/branches{/branch}","tags_url":"https://api.github.com/repos/apache/bookkeeper/tags","blobs_url":"https://api.github.com/repos/apache/bookkeeper/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/bookkeeper/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/bookkeeper/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/bookkeeper/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/bookkeeper/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/bookkeeper/languages","stargazers_url":"https://api.github.com/repos/apache/bookkeeper/stargazers","contributors_url":"https://api.github.com/repos/apache/bookkeeper/contributors","subscribers_url":"https://api.github.com/repos/apache/bookkeeper/subscribers","subscription_url":"https://api.github.com/repos/apache/bookkeeper/subscription","commits_url":"https://api.github.com/repos/apache/bookkeeper/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/bookkeeper/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/bookkeeper/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/bookkeeper/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/{+path}","compare_url":"https://api.github.com/repos/apache/bookkeeper/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/bookkeeper/merges","archive_url":"https://api.github.com/repos/apache/bookkeeper/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/bookkeeper/downloads","issues_url":"https://api.github.com/repos/apache/bookkeeper/issues{/number}","pulls_url":"https://api.github.com/repos/apache/bookkeeper/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/bookkeeper/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/bookkeeper/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/bookkeeper/labels{/name}","releases_url":"https://api.github.com/repos/apache/bookkeeper/releases{/id}","deployments_url":"https://api.github.com/repos/apache/bookkeeper/deployments"},"score":18.424097},{"url":"https://api.github.com/repos/apache/bookkeeper/commits/fc8097f33242d6b1a6cbcce10466fb5bfc663b5a","sha":"fc8097f33242d6b1a6cbcce10466fb5bfc663b5a","html_url":"https://github.com/apache/bookkeeper/commit/fc8097f33242d6b1a6cbcce10466fb5bfc663b5a","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/fc8097f33242d6b1a6cbcce10466fb5bfc663b5a/comments","commit":{"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/fc8097f33242d6b1a6cbcce10466fb5bfc663b5a","author":{"date":"2018-03-14T11:15:54.000-07:00","name":"Jia Zhai","email":"zhaijia@apache.org"},"committer":{"date":"2018-03-14T11:15:54.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"message":"ISSUE #762: copy codahale files to org.apache.bookkeeper.stats.codahale\n\nDescriptions of the changes in this PR:\nCodahale stats providers are sharing same package name with the stats library org.apache.bookkeeper.stats. We should consider moving them to their own package name.\n`org.apache.bookkeeper.stats => org.apache.bookkeeper.stats.codahale`\n\nFor BC concerns, we need to do this in two phases:\n- in 4.7, we copy the files but still have the old files for BC. but mark the old classes as deprecated.\n- in 4.8, we remove the old files.\nbecause the class names are used for reflection.\n\nMaster Issue: #762\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1257 from jiazhai/issue_762, closes #762","tree":{"url":"https://api.github.com/repos/apache/bookkeeper/git/trees/aa264358fe1aaf5ee0e4be610f2b451adf5ead40","sha":"aa264358fe1aaf5ee0e4be610f2b451adf5ead40"},"comment_count":0},"author":null,"committer":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"parents":[{"url":"https://api.github.com/repos/apache/bookkeeper/commits/7e8980fff096a9111e9365d0dc959af0625a87db","html_url":"https://github.com/apache/bookkeeper/commit/7e8980fff096a9111e9365d0dc959af0625a87db","sha":"7e8980fff096a9111e9365d0dc959af0625a87db"}],"repository":{"id":1575956,"name":"bookkeeper","full_name":"apache/bookkeeper","owner":{"login":"apache","id":47359,"avatar_url":"https://avatars0.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/apache/bookkeeper","description":"Apache Bookkeeper","fork":false,"url":"https://api.github.com/repos/apache/bookkeeper","forks_url":"https://api.github.com/repos/apache/bookkeeper/forks","keys_url":"https://api.github.com/repos/apache/bookkeeper/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/bookkeeper/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/bookkeeper/teams","hooks_url":"https://api.github.com/repos/apache/bookkeeper/hooks","issue_events_url":"https://api.github.com/repos/apache/bookkeeper/issues/events{/number}","events_url":"https://api.github.com/repos/apache/bookkeeper/events","assignees_url":"https://api.github.com/repos/apache/bookkeeper/assignees{/user}","branches_url":"https://api.github.com/repos/apache/bookkeeper/branches{/branch}","tags_url":"https://api.github.com/repos/apache/bookkeeper/tags","blobs_url":"https://api.github.com/repos/apache/bookkeeper/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/bookkeeper/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/bookkeeper/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/bookkeeper/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/bookkeeper/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/bookkeeper/languages","stargazers_url":"https://api.github.com/repos/apache/bookkeeper/stargazers","contributors_url":"https://api.github.com/repos/apache/bookkeeper/contributors","subscribers_url":"https://api.github.com/repos/apache/bookkeeper/subscribers","subscription_url":"https://api.github.com/repos/apache/bookkeeper/subscription","commits_url":"https://api.github.com/repos/apache/bookkeeper/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/bookkeeper/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/bookkeeper/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/bookkeeper/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/{+path}","compare_url":"https://api.github.com/repos/apache/bookkeeper/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/bookkeeper/merges","archive_url":"https://api.github.com/repos/apache/bookkeeper/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/bookkeeper/downloads","issues_url":"https://api.github.com/repos/apache/bookkeeper/issues{/number}","pulls_url":"https://api.github.com/repos/apache/bookkeeper/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/bookkeeper/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/bookkeeper/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/bookkeeper/labels{/name}","releases_url":"https://api.github.com/repos/apache/bookkeeper/releases{/id}","deployments_url":"https://api.github.com/repos/apache/bookkeeper/deployments"},"score":19.582533},{"url":"https://api.github.com/repos/apache/bookkeeper/commits/7e8980fff096a9111e9365d0dc959af0625a87db","sha":"7e8980fff096a9111e9365d0dc959af0625a87db","html_url":"https://github.com/apache/bookkeeper/commit/7e8980fff096a9111e9365d0dc959af0625a87db","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/7e8980fff096a9111e9365d0dc959af0625a87db/comments","commit":{"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/7e8980fff096a9111e9365d0dc959af0625a87db","author":{"date":"2018-03-14T11:03:05.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"committer":{"date":"2018-03-14T11:03:05.000-07:00","name":"Sijie Guo","email":"sijie@apache.org"},"message":"ISSUE #1255: Bookie should not advance the journal marker before creating the index file\n\nDescriptions of the changes in this PR:\n\n*Problem*\n\nCurrently Bookie journal 'new ledger' entry if a ledger doesn't exist at ledger storage. This 'new ledger' entry is journaled before adding the entry to ledger storage. so this would cause a problem on checkpointing.\n\n- journal 'new ledger' entry\n\n```\n    /**\n     * Retrieve the ledger descriptor for the ledger which entry should be added to.\n     * The LedgerDescriptor returned from this method should be eventually freed with\n     * #putHandle().\n     *\n     * throws BookieException if masterKey does not match the master key of the ledger\n     */\n    private LedgerDescriptor getLedgerForEntry(ByteBuf entry, final byte[] masterKey)\n            throws IOException, BookieException {\n        final long ledgerId = entry.getLong(entry.readerIndex());\n\n        LedgerDescriptor l = handles.getHandle(ledgerId, masterKey);\n        if (masterKeyCache.get(ledgerId) == null) {\n            // Force the load into masterKey cache\n            byte[] oldValue = masterKeyCache.putIfAbsent(ledgerId, masterKey);\n            if (oldValue == null) {\n                // new handle, we should add the key to journal ensure we can rebuild\n                ByteBuffer bb = ByteBuffer.allocate(8 + 8 + 4 + masterKey.length);\n                bb.putLong(ledgerId);\n                bb.putLong(METAENTRY_ID_LEDGER_KEY);\n                bb.putInt(masterKey.length);\n                bb.put(masterKey);\n                bb.flip();\n\n                getJournal(ledgerId).logAddEntry(bb, false /* ackBeforeSync */, new NopWriteCallback(), null);\n            }\n        }\n\n        return l;\n    }\n```\n\n- add entry to ledger storage\n```\n    /**\n     * Add an entry to a ledger as specified by handle.\n     */\n    private void addEntryInternal(LedgerDescriptor handle, ByteBuf entry,\n                                  boolean ackBeforeSync, WriteCallback cb, Object ctx)\n            throws IOException, BookieException {\n        long ledgerId = handle.getLedgerId();\n        long entryId = handle.addEntry(entry);\n\n        writeBytes.add(entry.readableBytes());\n\n        if (LOG.isTraceEnabled()) {\n            LOG.trace(\"Adding {}{}\", entryId, ledgerId);\n        }\n        getJournal(ledgerId).logAddEntry(entry, ackBeforeSync, cb, ctx);\n    }\n\n```\n\nThe problematic sequence can be described as below:\n\n- thread t1 is adding the first entry of ledger L1\n- thread t2 is adding entries of ledger L2\n- t1 is adding a journal entry of 'new ledger L1'\n- t2 is adding entries after t1 adds the journal entry and before t1 adding the entry to ledger storage\n- after t2 added entries, checkpoint happens in the ledger storage. it would roll the journal mark, which will claim the 'new ledger L1' entry as persistent.\n- if the bookie restarts, it would fail with no such ledger exception.\n\nThe problem can be produced using a unit test: https://github.com/sijie/bookkeeper/commit/5053a717cd578aeb88236d373553d7494501b801\n\n*Solution*\n\nThe fix is simple - just make sure the 'new ledger' journal entry is added after an entry is added to ledger storage. so it make sure when checkpoint happen it will flush and create the ledger before moving the journal mark.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Charan Reddy Guttapalem <reddycharan18@gmail.com>, Jia Zhai <None>, Yiming Zang <yzang2016@gmail.com>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1256 from sijie/fix_db_ledger_storage_checkpoint, closes #1255","tree":{"url":"https://api.github.com/repos/apache/bookkeeper/git/trees/ca6e873f5e36d1936c3d1a629815b87941cd93c4","sha":"ca6e873f5e36d1936c3d1a629815b87941cd93c4"},"comment_count":0},"author":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"committer":{"login":"sijie","id":1217863,"avatar_url":"https://avatars2.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"parents":[{"url":"https://api.github.com/repos/apache/bookkeeper/commits/96ff1c0d44bf1ac6b0ce3ca21053ae10ab7e2294","html_url":"https://github.com/apache/bookkeeper/commit/96ff1c0d44bf1ac6b0ce3ca21053ae10ab7e2294","sha":"96ff1c0d44bf1ac6b0ce3ca21053ae10ab7e2294"}],"repository":{"id":1575956,"name":"bookkeeper","full_name":"apache/bookkeeper","owner":{"login":"apache","id":47359,"avatar_url":"https://avatars0.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/apache/bookkeeper","description":"Apache Bookkeeper","fork":false,"url":"https://api.github.com/repos/apache/bookkeeper","forks_url":"https://api.github.com/repos/apache/bookkeeper/forks","keys_url":"https://api.github.com/repos/apache/bookkeeper/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/bookkeeper/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/bookkeeper/teams","hooks_url":"https://api.github.com/repos/apache/bookkeeper/hooks","issue_events_url":"https://api.github.com/repos/apache/bookkeeper/issues/events{/number}","events_url":"https://api.github.com/repos/apache/bookkeeper/events","assignees_url":"https://api.github.com/repos/apache/bookkeeper/assignees{/user}","branches_url":"https://api.github.com/repos/apache/bookkeeper/branches{/branch}","tags_url":"https://api.github.com/repos/apache/bookkeeper/tags","blobs_url":"https://api.github.com/repos/apache/bookkeeper/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/bookkeeper/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/bookkeeper/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/bookkeeper/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/bookkeeper/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/bookkeeper/languages","stargazers_url":"https://api.github.com/repos/apache/bookkeeper/stargazers","contributors_url":"https://api.github.com/repos/apache/bookkeeper/contributors","subscribers_url":"https://api.github.com/repos/apache/bookkeeper/subscribers","subscription_url":"https://api.github.com/repos/apache/bookkeeper/subscription","commits_url":"https://api.github.com/repos/apache/bookkeeper/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/bookkeeper/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/bookkeeper/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/bookkeeper/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/{+path}","compare_url":"https://api.github.com/repos/apache/bookkeeper/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/bookkeeper/merges","archive_url":"https://api.github.com/repos/apache/bookkeeper/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/bookkeeper/downloads","issues_url":"https://api.github.com/repos/apache/bookkeeper/issues{/number}","pulls_url":"https://api.github.com/repos/apache/bookkeeper/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/bookkeeper/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/bookkeeper/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/bookkeeper/labels{/name}","releases_url":"https://api.github.com/repos/apache/bookkeeper/releases{/id}","deployments_url":"https://api.github.com/repos/apache/bookkeeper/deployments"},"score":18.152592}]}